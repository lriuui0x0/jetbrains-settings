<application>
  <component name="VimEditorSettings">
    <editor>
      <key-repeat enabled="true" />
    </editor>
  </component>
  <component name="VimHistorySettings">
    <history>
      <history-search>
        <entry>getContext</entry>
        <entry>parent</entry>
        <entry>owner</entry>
        <entry encoding="base64">XDxGdW5jdGlvblw+</entry>
        <entry encoding="base64">XDxleGVjdXRvclw+</entry>
        <entry encoding="base64">XDxzdGF0ZVw+</entry>
        <entry>state</entry>
        <entry>close</entry>
        <entry encoding="base64">XDxwcm90ZWN0ZWRcPg==</entry>
        <entry encoding="base64">XDxncmFrblNlcnZlckFjdG9yXD4=</entry>
        <entry encoding="base64">XDxpbml0XD4=</entry>
        <entry>thenWaitUntil</entry>
        <entry encoding="base64">XDxkYXRhYmFzZU1hbmFnZXJBY3Rvclw+</entry>
        <entry encoding="base64">XDxvcGVuXD4=</entry>
        <entry encoding="base64">XDxhY3RpdmF0ZVw+</entry>
        <entry>then</entry>
        <entry>try</entry>
        <entry encoding="base64">XDxsb29wXD4=</entry>
        <entry encoding="base64">XDxjb21tb25Qcm9taXNlRXhlY3V0b3JcPg==</entry>
        <entry encoding="base64">XDxzbGVlcFw+</entry>
      </history-search>
      <history-cmd>
        <entry>wjj:w</entry>
        <entry encoding="base64">JzwsJz4=</entry>
        <entry>wo</entry>
        <entry>w\jjb</entry>
        <entry>wbhb</entry>
        <entry>v</entry>
        <entry>W</entry>
        <entry>w:q</entry>
        <entry>ww</entry>
        <entry encoding="base64">JzwsJz53</entry>
        <entry>:w</entry>
        <entry>w\</entry>
        <entry>w:w</entry>
        <entry>s</entry>
        <entry>wi</entry>
        <entry>q\</entry>
        <entry>;w</entry>
        <entry>vs</entry>
        <entry>q</entry>
        <entry>w</entry>
      </history-cmd>
      <history-expr />
      <history-input />
    </history>
  </component>
  <component name="VimKeySettings">
    <shortcut-conflicts>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed OPEN_BRACKET</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed V</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed D</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed U</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed B</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed J</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed K</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed L</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed A</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed W</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed X</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed M</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed N</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>shift ctrl pressed 2</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed C</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed Y</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed O</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed P</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed E</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed F</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed Q</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed 2</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed R</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed G</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed H</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed CLOSE_BRACKET</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>shift ctrl pressed 6</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed S</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed T</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>ctrl pressed I</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed SEMICOLON</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>shift ctrl pressed SEMICOLON</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed Q</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed R</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed M</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed X</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed J</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed BACK_SPACE</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed Z</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed B</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed COMMA</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed N</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed C</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed V</text>
      </shortcut-conflict>
      <shortcut-conflict owner="ide">
        <text>alt pressed L</text>
      </shortcut-conflict>
    </shortcut-conflicts>
  </component>
  <component name="VimMarksSettings">
    <globalmarks />
    <filemarks>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/PromiseExecutor.java" timestamp="1601913092570">
        <mark key="'" line="7" column="33" />
        <mark key="[" line="7" column="0" />
        <mark key="]" line="7" column="22" />
        <mark key="." line="7" column="0" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/server/components/storage/RocksData.java" timestamp="1601903978127">
        <mark key="'" line="518" column="0" />
        <mark key="[" line="35" column="4" />
        <mark key="]" line="35" column="10" />
        <mark key="." line="35" column="9" />
        <mark key="^" line="35" column="10" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" timestamp="1601915440762">
        <mark key="'" line="25" column="190" />
        <mark key="[" line="25" column="4" />
        <mark key="]" line="25" column="10" />
        <mark key="^" line="25" column="10" />
        <mark key="." line="25" column="9" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" timestamp="1601974673687">
        <mark key="'" line="36" column="0" />
        <mark key="[" line="44" column="80" />
        <mark key="]" line="44" column="85" />
        <mark key="." line="44" column="84" />
        <mark key="^" line="44" column="85" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Data.java" timestamp="1601912684985">
        <mark key="'" line="22" column="49" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" timestamp="1601913821961">
        <mark key="'" line="38" column="19" />
        <mark key="[" line="38" column="26" />
        <mark key="]" line="38" column="26" />
        <mark key="." line="38" column="26" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/server/GraknServer.java" timestamp="1601915423930">
        <mark key="'" line="72" column="4" />
        <mark key="^" line="2" column="63" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" timestamp="1601913106631" />
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/ActorPeriodicTask.java" timestamp="1601973790595">
        <mark key="'" line="7" column="0" />
        <mark key="[" line="8" column="32" />
        <mark key="]" line="8" column="32" />
        <mark key="^" line="8" column="32" />
        <mark key="." line="8" column="31" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/testkit/TestState.java" timestamp="1601974656499">
        <mark key="'" line="18" column="35" />
        <mark key="[" line="7" column="4" />
        <mark key="]" line="7" column="10" />
        <mark key="." line="7" column="9" />
        <mark key="^" line="7" column="10" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grabl/local/grabl.env" timestamp="1601906899325">
        <mark key="[" line="9" column="0" />
        <mark key="]" line="10" column="93" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/BUILD" timestamp="1601973941844">
        <mark key="'" line="0" column="0" />
        <mark key="[" line="0" column="0" />
        <mark key="]" line="10" column="1" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/server/components/storage/RocksStorageManager.java" timestamp="1601904030657">
        <mark key="'" line="145" column="0" />
        <mark key="[" line="23" column="4" />
        <mark key="]" line="23" column="10" />
        <mark key="." line="23" column="9" />
        <mark key="^" line="23" column="10" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" timestamp="1601974461143">
        <mark key="'" line="202" column="0" />
        <mark key="[" line="0" column="0" />
        <mark key="]" line="200" column="0" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" timestamp="1601974507901">
        <mark key="'" line="677" column="24" />
        <mark key="[" line="0" column="0" />
        <mark key="]" line="745" column="1" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" timestamp="1601913120905">
        <mark key="'" line="5" column="0" />
        <mark key="[" line="38" column="18" />
        <mark key="]" line="38" column="19" />
        <mark key="." line="38" column="18" />
        <mark key="^" line="38" column="19" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Promise.java" timestamp="1601913707736">
        <mark key="'" line="167" column="8" />
      </file>
      <file name="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" timestamp="1601973732632">
        <mark key="'" line="60" column="0" />
        <mark key="[" line="0" column="0" />
        <mark key="]" line="62" column="1" />
        <mark key="." line="0" column="0" />
      </file>
    </filemarks>
    <jumps>
      <jump line="36" column="13" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="37" column="36" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="30" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="52" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="48" column="71" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="72" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="73" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="49" column="84" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="54" column="116" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="67" column="17" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="61" column="28" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="37" column="62" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="35" column="148" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="38" column="17" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="34" column="21" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="24" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Data.java" />
      <jump line="31" column="205" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="60" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="26" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="34" column="44" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="69" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="201" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="44" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="745" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="28" column="11" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="36" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="42" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="743" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="43" column="87" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="27" column="191" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="34" column="23" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="40" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="57" column="49" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="201" column="24" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="69" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="75" column="8" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="19" column="20" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="39" column="16" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="40" column="14" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="108" column="24" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="110" column="43" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="22" column="49" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Data.java" />
      <jump line="23" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="7" column="59" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="56" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="59" column="67" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="5" column="34" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/PromiseExecutor.java" />
      <jump line="7" column="33" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/PromiseExecutor.java" />
      <jump line="47" column="53" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="42" column="33" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/Database.java" />
      <jump line="13" column="27" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="5" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/DatabaseManager.java" />
      <jump line="54" column="60" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="65" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="39" column="19" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="8" column="74" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="66" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="54" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="13" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="62" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="52" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="62" column="12" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Promise.java" />
      <jump line="107" column="23" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Promise.java" />
      <jump line="167" column="8" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Promise.java" />
      <jump line="38" column="19" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/EventLoopPromiseExecutor.java" />
      <jump line="48" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="46" column="50" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="34" column="52" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="74" column="46" filename="$USER_HOME$/GraknLabs/grakn-cluster/server/GraknServer.java" />
      <jump line="71" column="101" filename="$USER_HOME$/GraknLabs/grakn-cluster/server/GraknServer.java" />
      <jump line="83" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/server/GraknServer.java" />
      <jump line="32" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="25" column="190" filename="$USER_HOME$/GraknLabs/grakn-cluster/distributed/core/TransactionManager.java" />
      <jump line="28" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="6" column="45" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="14" column="4" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="0" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="3" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="60" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/Actor.java" />
      <jump line="8" column="57" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/ActorPeriodicTask.java" />
      <jump line="67" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/ActorPeriodicTask.java" />
      <jump line="7" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/ActorPeriodicTask.java" />
      <jump line="11" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/BUILD" />
      <jump line="0" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/BUILD" />
      <jump line="76" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="39" column="8" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="0" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="105" column="24" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="107" column="19" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="33" column="15" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="56" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="113" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="36" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/actor/test/ActorTest.java" />
      <jump line="32" column="46" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="0" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="202" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Peers.java" />
      <jump line="109" column="55" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="0" column="0" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="333" column="12" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
      <jump line="677" column="24" filename="$USER_HOME$/GraknLabs/grakn-cluster/concurrent/raft/Raft.java" />
    </jumps>
  </component>
  <component name="VimRegisterSettings">
    <registers>
      <register name="&quot;" type="4">
        <text>TestState::new</text>
      </register>
      <register name="+" type="2">
        <text encoding="base64">amF2YV9saWJyYXJ5KAogICAgbmFtZSA9ICJsaWIiLAogICAgc3JjcyA9IGdsb2IoWyIqLmphdmEiXSksCiAgICBkZXBzID0gWwogICAgICAgICIvL2NvbW1vbjpsaWIiLAogICAgICAgICJAbWF2ZW4vLzpjb21fZ29vZ2xlX2NvZGVfZmluZGJ1Z3NfanNyMzA1IiwKICAgICAgICAiQG1hdmVuLy86b3JnX3NsZjRqX3NsZjRqX2FwaSIsCiAgICBdLAogICAgdmlzaWJpbGl0eSA9IFsiLy92aXNpYmlsaXR5OnB1YmxpYyJdLAogICAgdGFncyA9IFsibWF2ZW5fY29vcmRpbmF0ZXM9aW8uZ3Jha24uY2x1c3Rlcjpjb25jdXJyZW50LWFjdG9yLWxpYjp7cG9tX3ZlcnNpb259Il0KKQo=</text>
      </register>
      <register name="l" type="4">
        <text>a</text>
      </register>
      <register name="-" type="4">
        <text>TestState::new</text>
      </register>
      <register name="/" type="4">
        <text encoding="base64">XDxzbGVlcFw+</text>
      </register>
      <register name="o" type="4">
        <keys>
          <key char="65535" code="91" mods="130" />
        </keys>
      </register>
      <register name="0" type="2">
        <text encoding="base64">ICAgICAgICBBY3RvcjxUZXN0U3RhdGU+IHJvb3QgPSBBY3Rvci5yb290KHJvb3RMb29wLCBUZXN0U3RhdGU6Om5ldyk7Cg==</text>
      </register>
      <register name="1" type="2">
        <text encoding="base64">cGFja2FnZSBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdDsKCmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21tb24uUmFmdElkOwppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LmFjdG9yLkFjdG9yOwppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LmFjdG9yLkFjdG9yUGVyaW9kaWNUYXNrOwppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LmFjdG9yLlByb21pc2U7CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21wb25lbnRzLk5ldHdvcmtpbmc7CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21wb25lbnRzLlRlcm07CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21wb25lbnRzLkFwcGxpY2F0b3I7CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21wb25lbnRzLkxvZzsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBqYXZheC5hbm5vdGF0aW9uLk51bGxhYmxlOwppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEudXRpbC4qOwppbXBvcnQgamF2YS51dGlsLmZ1bmN0aW9uLkNvbnN1bWVyOwppbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzOwoKaW1wb3J0IHN0YXRpYyBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5jb21tb24uRHVyYXRpb25zLio7CmltcG9ydCBzdGF0aWMgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LnJhZnQuY29tbW9uLlV0aWwuZ2V0TWFqb3JpdHlDb3VudDsKaW1wb3J0IHN0YXRpYyBncmFrbi5jb21tb24uY29sbGVjdGlvbi5Db2xsZWN0aW9ucy5saXN0OwppbXBvcnQgc3RhdGljIGdyYWtuLmNvbW1vbi5jb2xsZWN0aW9uLkNvbGxlY3Rpb25zLnNldDsKaW1wb3J0IHN0YXRpYyBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdC5SZXBsaWNhdGlvbnMuUmVwbGljYXRpb24uQ291bnRzLio7CgpwdWJsaWMgY2xhc3MgUmFmdCB7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoUmFmdC5jbGFzcyk7CgogICAgQWN0b3I8UmFmdD4gYWN0b3I7CiAgICBTdGF0ZXMuQmFzZSBzdGF0ZTsKICAgIEFjdG9yPFBlZXJzPiBwZWVyc0FjdG9yOwoKICAgIHB1YmxpYyBzdGF0aWMgUHJvbWlzZTxBY3RvcjxSYWZ0Pj4gY3JlYXRlKEFjdG9yPD8+IHBhcmVudEFjdG9yLCBSYWZ0SWQgaWQsIFNldDxSYWZ0SWQ+IHBlZXJzLCBMb2cgbG9nLCBUZXJtIHRlcm0sIEFjdG9yPD8gZXh0ZW5kcyBBcHBsaWNhdG9yPiBhcHBsaWNhdG9yLCBBY3Rvcjw/IGV4dGVuZHMgTmV0d29ya2luZz4gbmV0d29ya2luZ0FjdG9yKSB7CiAgICAgICAgUHJvbWlzZTxBY3RvcjxSYWZ0Pj4gY2hpbGQgPSBwYXJlbnRBY3Rvci5jaGlsZChSYWZ0OjpuZXcpOwogICAgICAgIHJldHVybiBjaGlsZC50aGVuV2FpdFVudGlsKHJhZnRBY3RvciAtPiByYWZ0QWN0b3IucnVuKHJhZnQgLT4gcmFmdC5pbml0KHJhZnRBY3RvciwgaWQsIHBlZXJzLCB0ZXJtLCBsb2csIGFwcGxpY2F0b3IsIG5ldHdvcmtpbmdBY3RvciwgRUxFQ1RJT05fVElNRU9VVF9NUywgRUxFQ1RJT05fVElNRU9VVF9WQVJJQVRJT05fTVMsIEhFQVJUQkVBVF9JTlRFUlZBTF9NUykpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbml0KEFjdG9yPFJhZnQ+IGFjdG9yLCBSYWZ0SWQgaWQsIFNldDxSYWZ0SWQ+IHBlZXJzLCBUZXJtIHRlcm0sIExvZyBsb2csIEFjdG9yPD8gZXh0ZW5kcyBBcHBsaWNhdG9yPiBhcHBsaWNhdG9yLCBBY3Rvcjw/IGV4dGVuZHMgTmV0d29ya2luZz4gbmV0d29ya2luZ0FjdG9yLCBpbnQgZWxlY3Rpb25UaW1lb3V0TXMsIGludCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaW50IGhlYXJ0YmVhdEludGVydmFsTXMpIHsKICAgICAgICB0aGlzLmFjdG9yID0gYWN0b3I7CiAgICAgICAgcGVlcnNBY3RvciA9IFBlZXJzLmNyZWF0ZShhY3RvciwgYWN0b3IsIG5ldHdvcmtpbmdBY3RvcikuYXdhaXRVbmNoZWNrZWQoKTsKICAgICAgICBzdGF0ZSA9IG5ldyBTdGF0ZXMuSW5hY3RpdmUoCiAgICAgICAgICAgICAgICBpZCwgcGVlcnMsIHRlcm0sIGxvZywgYXBwbGljYXRvciwgcGVlcnNBY3RvciwgdGhpczo6b25UcmFuc2l0aW9uLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMsIGFjdG9yCiAgICAgICAgKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhY3RpdmF0ZSgpIHsKICAgICAgICBzdGF0ZS5hY3RpdmF0ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRlYWN0aXZhdGUoKSB7CiAgICAgICAgc3RhdGUuZGVhY3RpdmF0ZSgpOwogICAgfQoKICAgIHB1YmxpYyBTdGF0ZXMuU3RhdHVzIHN0YXR1cygpIHsKICAgICAgICByZXR1cm4gc3RhdGUuc3RhdHVzKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVwbGljYXRlKEJ5dGVCdWZmZXIgY29udGVudCwgQ29uc3VtZXI8Vm9pZD4gb25Db21taXR0ZWQpIHsKICAgICAgICBzdGF0ZS5yZXBsaWNhdGUoY29udGVudCwgb25Db21taXR0ZWQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlcXVlc3RWb3RlUmVxKFJhZnRJZCBjYW5kaWRhdGUsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5KSB7CiAgICAgICAgc3RhdGUucmVxdWVzdFZvdGVSZXEoY2FuZGlkYXRlLCB0ZXJtLCBsYXRlc3RFbnRyeSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVxdWVzdFZvdGVSZXMoUmFmdElkIHBlZXIsIGxvbmcgdGVybSwgYm9vbGVhbiB2b3RlR3JhbnRlZCkgewogICAgICAgIHN0YXRlLnJlcXVlc3RWb3RlUmVzKHBlZXIsIHRlcm0sIHZvdGVHcmFudGVkKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRFbnRyaWVzUmVxKFJhZnRJZCBsZWFkZXIsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIHByZXZFbnRyeUlkLCBMaXN0PExvZy5FbnRyeT4gZW50cmllcywgQE51bGxhYmxlIExvbmcgbGVhZGVyQ29tbWl0KSB7CiAgICAgICAgc3RhdGUuYXBwZW5kRW50cmllc1JlcShsZWFkZXIsIHRlcm0sIHByZXZFbnRyeUlkLCBlbnRyaWVzLCBsZWFkZXJDb21taXQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFwcGVuZEVudHJpZXNSZXMoUmFmdElkIGZvbGxvd2VyLCBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkLCBsb25nIHRlcm0sIGJvb2xlYW4gc3VjY2VzcykgewogICAgICAgIHN0YXRlLmFwcGVuZEVudHJpZXNSZXMoZm9sbG93ZXIsIHRlcm0sIGxhdGVzdEVudHJ5SWQsIHN1Y2Nlc3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG9uVHJhbnNpdGlvbihATnVsbGFibGUgU3RhdGVzLkJhc2UgbmV3U3RhdGUpIHsKCiAgICAgICAgaWYgKG5ld1N0YXRlICE9IG51bGwpIHsKICAgICAgICAgICAgTE9HLmRlYnVnKCIne30nIC0+ICd7fTp7fSciLCBzdGF0ZSwgbmV3U3RhdGUsIG5ld1N0YXRlLnRlcm0uZ2V0VGVybSgpKTsKICAgICAgICAgICAgc3RhdGUgPSBuZXdTdGF0ZTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludGVyZmFjZSBTdGF0ZXMgewogICAgICAgIGFic3RyYWN0IGNsYXNzIEJhc2UgewogICAgICAgICAgICBmaW5hbCBSYWZ0SWQgaWQ7CiAgICAgICAgICAgIGZpbmFsIFNldDxSYWZ0SWQ+IHBlZXJzOwogICAgICAgICAgICBmaW5hbCBUZXJtIHRlcm07CiAgICAgICAgICAgIGZpbmFsIExvZyBsb2c7CiAgICAgICAgICAgIGZpbmFsIEFjdG9yPD8gZXh0ZW5kcyBBcHBsaWNhdG9yPiBhcHBsaWNhdG9yQWN0b3I7CiAgICAgICAgICAgIGZpbmFsIEFjdG9yPFBlZXJzPiBwZWVyc0FjdG9yOwogICAgICAgICAgICBmaW5hbCBDb25zdW1lcjxCYXNlPiBvblRyYW5zaXRpb247CiAgICAgICAgICAgIEBOdWxsYWJsZQogICAgICAgICAgICBSYWZ0SWQgbGFzdEtub3duTGVhZGVyOwogICAgICAgICAgICBmaW5hbCBpbnQgZWxlY3Rpb25UaW1lb3V0TXM7CiAgICAgICAgICAgIGZpbmFsIGludCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NczsKICAgICAgICAgICAgZmluYWwgaW50IGhlYXJ0YmVhdEludGVydmFsTXM7CgogICAgICAgICAgICBCYXNlKFJhZnRJZCBpZCwgU2V0PFJhZnRJZD4gcGVlcnMsIFRlcm0gdGVybSwgTG9nIGxvZywgQWN0b3I8PyBleHRlbmRzIEFwcGxpY2F0b3I+IGFwcGxpY2F0b3JBY3RvciwgQWN0b3I8UGVlcnM+IHBlZXJzQWN0b3IsIENvbnN1bWVyPEJhc2U+IG9uVHJhbnNpdGlvbiwgUmFmdElkIGxhc3RLbm93bkxlYWRlciwgaW50IGVsZWN0aW9uVGltZW91dE1zLCBpbnQgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGludCBoZWFydGJlYXRJbnRlcnZhbE1zKSB7CiAgICAgICAgICAgICAgICB0aGlzLmlkID0gaWQ7CiAgICAgICAgICAgICAgICB0aGlzLnBlZXJzID0gcGVlcnM7CiAgICAgICAgICAgICAgICB0aGlzLnRlcm0gPSB0ZXJtOwogICAgICAgICAgICAgICAgdGhpcy5sb2cgPSBsb2c7CiAgICAgICAgICAgICAgICB0aGlzLmFwcGxpY2F0b3JBY3RvciA9IGFwcGxpY2F0b3JBY3RvcjsKICAgICAgICAgICAgICAgIHRoaXMucGVlcnNBY3RvciA9IHBlZXJzQWN0b3I7CiAgICAgICAgICAgICAgICB0aGlzLm9uVHJhbnNpdGlvbiA9IG9uVHJhbnNpdGlvbjsKICAgICAgICAgICAgICAgIHRoaXMubGFzdEtub3duTGVhZGVyID0gbGFzdEtub3duTGVhZGVyOwogICAgICAgICAgICAgICAgdGhpcy5lbGVjdGlvblRpbWVvdXRNcyA9IGVsZWN0aW9uVGltZW91dE1zOwogICAgICAgICAgICAgICAgdGhpcy5lbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcyA9IGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zOwogICAgICAgICAgICAgICAgdGhpcy5oZWFydGJlYXRJbnRlcnZhbE1zID0gaGVhcnRiZWF0SW50ZXJ2YWxNczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgYWN0aXZhdGUoKSB7CiAgICAgICAgICAgICAgICBsb2coKS5pbmZvKAogICAgICAgICAgICAgICAgICAgICAgICAiVW5hYmxlIHRvIHByb2Nlc3MgYWN0aXZhdGUoKSB3aGlsZSBpbiBzdGF0ZSAnIiArIHRoaXMgKyAiLiBJZ25vcmluZy4uLiIKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGRlYWN0aXZhdGUoKSB7CiAgICAgICAgICAgICAgICBsb2coKS5pbmZvKAogICAgICAgICAgICAgICAgICAgICAgICAiVW5hYmxlIHRvIHByb2Nlc3MgZGVhY3RpdmF0ZSgpIHdoaWxlIGluIHN0YXRlICciICsgdGhpcyArICIuIElnbm9yaW5nLi4uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFN0YXR1cyBzdGF0dXMoKSB7CiAgICAgICAgICAgICAgICBIYXNoU2V0PFJhZnRJZD4gbm9uTGVhZGVycyA9IG5ldyBIYXNoU2V0PD4oKTsKICAgICAgICAgICAgICAgIG5vbkxlYWRlcnMuYWRkKGlkKTsKICAgICAgICAgICAgICAgIG5vbkxlYWRlcnMuYWRkQWxsKHBlZXJzKTsKICAgICAgICAgICAgICAgIG5vbkxlYWRlcnMucmVtb3ZlKGxhc3RLbm93bkxlYWRlcik7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0YXR1cyh0ZXJtLmdldFRlcm0oKSwgbGFzdEtub3duTGVhZGVyLCBub25MZWFkZXJzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgcmVwbGljYXRlKEJ5dGVCdWZmZXIgY29udGVudCwgQ29uc3VtZXI8Vm9pZD4gb25Db21taXR0ZWQpIHsKICAgICAgICAgICAgICAgIGxvZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAgICAgICJVbmFibGUgdG8gcHJvY2VzcyByZXBsaWNhdGUoY29udGVudCwgb25Db21taXR0ZWQpIHdoaWxlIGluIHN0YXRlICciICsgdGhpcyArICIuIElnbm9yaW5nLi4uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgcmVxdWVzdFZvdGVSZXEoUmFmdElkIGNhbmRpZGF0ZSwgbG9uZyB0ZXJtLCBATnVsbGFibGUgTG9nLkVudHJ5SWQgbGF0ZXN0RW50cnlJZCkgewogICAgICAgICAgICAgICAgbG9nKCkuaW5mbygKICAgICAgICAgICAgICAgICAgICAgICAgIlVuYWJsZSB0byBwcm9jZXNzIHJlcXVlc3RWb3RlUmVxKCIgKyBjYW5kaWRhdGUgKyAiLCAiICsgdGVybSArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIikgd2hpbGUgaW4gc3RhdGUgJyIgKyB0aGlzICsgIi4gSWdub3JpbmcuLi4iCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXF1ZXN0Vm90ZVJlcyhSYWZ0SWQgcGVlciwgbG9uZyB0ZXJtLCBib29sZWFuIHZvdGVHcmFudGVkKSB7CiAgICAgICAgICAgICAgICBsb2coKS5pbmZvKAogICAgICAgICAgICAgICAgICAgICAgICAiVW5hYmxlIHRvIHByb2Nlc3MgcmVxdWVzdFZvdGVSZXMoIiArIHBlZXIgKyAiLCAiICsgdGVybSArICIsICIgKyB2b3RlR3JhbnRlZCArICIpIHdoaWxlIGluIHN0YXRlICciICsgdGhpcyArICIuIElnbm9yaW5nLi4uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgYXBwZW5kRW50cmllc1JlcShSYWZ0SWQgbGVhZGVyLCBsb25nIHRlcm0sIEBOdWxsYWJsZSBMb2cuRW50cnlJZCBwcmV2RW50cnlJZCwgTGlzdDxMb2cuRW50cnk+IGVudHJpZXMsIEBOdWxsYWJsZSBMb25nIGxlYWRlckNvbW1pdCkgewogICAgICAgICAgICAgICAgbG9nKCkuaW5mbygKICAgICAgICAgICAgICAgICAgICAgICAgIlVuYWJsZSB0byBwcm9jZXNzIGFwcGVuZEVudHJpZXNSZXEoIiArIGxlYWRlciArICIsICIgKyB0ZXJtICsgIiwgIiArIHByZXZFbnRyeUlkICsgIiwgIiArIGVudHJpZXMgKyAiLCAiICsgbGVhZGVyQ29tbWl0ICsgIikgd2hpbGUgaW4gc3RhdGUgJyIgKyB0aGlzICsgIi4gSWdub3JpbmcuLi4iCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBhcHBlbmRFbnRyaWVzUmVzKFJhZnRJZCBmb2xsb3dlciwgbG9uZyB0ZXJtLCBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkLCBib29sZWFuIHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIGxvZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAgICAgICJVbmFibGUgdG8gcHJvY2VzcyBhcHBlbmRFbnRyaWVzUmVxKCIgKyBmb2xsb3dlciArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIiwgIiArIHRlcm0gKyAiLCAiICsgc3VjY2VzcyArICIpIHdoaWxlIGluIHN0YXRlICciICsgdGhpcyArICIuIElnbm9yaW5nLi4uIgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaXNMZWFkZXIoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIExlYWRlcjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIExlYWRlciBhc0xlYWRlcigpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoTGVhZGVyKSB0aGlzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc0NhbmRpZGF0ZSgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgQ2FuZGlkYXRlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgQ2FuZGlkYXRlIGFzQ2FuZGlkYXRlKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIChDYW5kaWRhdGUpIHRoaXM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIGlzRm9sbG93ZXIoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIEZvbGxvd2VyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgRm9sbG93ZXIgYXNGb2xsb3dlcigpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoRm9sbG93ZXIpIHRoaXM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGdldENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgTG9nZ2VyIGxvZygpOwogICAgICAgIH0KCiAgICAgICAgY2xhc3MgSW5hY3RpdmUgZXh0ZW5kcyBCYXNlIHsKICAgICAgICAgICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9nZ2VyIExPRyA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKEluYWN0aXZlLmNsYXNzKTsKCiAgICAgICAgICAgIGZpbmFsIEFjdG9yPFJhZnQ+IHJhZnRBY3RvcjsKCiAgICAgICAgICAgIHB1YmxpYyBJbmFjdGl2ZShSYWZ0SWQgaWQsIFNldDxSYWZ0SWQ+IHBlZXJzLCBUZXJtIHRlcm0sIExvZyBsb2csIEFjdG9yPD8gZXh0ZW5kcyBBcHBsaWNhdG9yPiBhcHBsaWNhdG9yQWN0b3IsIEFjdG9yPFBlZXJzPiBwZWVyc0FjdG9yLCBDb25zdW1lcjxCYXNlPiBvblRyYW5zaXRpb24sIGludCBlbGVjdGlvblRpbWVvdXRNcywgaW50IGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zLCBpbnQgaGVhcnRiZWF0SW50ZXJ2YWxNcywgQWN0b3I8UmFmdD4gcmFmdEFjdG9yKSB7CiAgICAgICAgICAgICAgICBzdXBlcihpZCwgcGVlcnMsIGluaXRUZXJtKHRlcm0pLCBsb2csIGFwcGxpY2F0b3JBY3RvciwgcGVlcnNBY3Rvciwgb25UcmFuc2l0aW9uLCBudWxsLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMpOwogICAgICAgICAgICAgICAgdGhpcy5yYWZ0QWN0b3IgPSByYWZ0QWN0b3I7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBhY3RpdmF0ZSgpIHsKICAgICAgICAgICAgICAgIGZvciAoUmFmdElkIGlkIDogcGVlcnMpIHsKICAgICAgICAgICAgICAgICAgICBwZWVyc0FjdG9yLnJ1bihwZWVycyAtPiBwZWVycy5jcmVhdGVQZWVyKGlkLmFkZHJlc3MoKSkpLmF3YWl0VW5jaGVja2VkKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocGVlcnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvTGVhZGVyKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25Ub0ZvbGxvd2VyKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwcm90ZWN0ZWQgTG9nZ2VyIGxvZygpIHsKICAgICAgICAgICAgICAgIHJldHVybiBMT0c7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCB0cmFuc2l0aW9uVG9MZWFkZXIoKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0xlYWRlcigpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIExlYWRlciBuZXdTdGF0ZSA9IG5ldyBMZWFkZXIoaWQsIHBlZXJzLCB0ZXJtLCBsb2csIGFwcGxpY2F0b3JBY3RvciwgcGVlcnNBY3Rvciwgb25UcmFuc2l0aW9uLCAtMSwgZWxlY3Rpb25UaW1lb3V0TXMsIGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zLCBoZWFydGJlYXRJbnRlcnZhbE1zLCByYWZ0QWN0b3IpOwogICAgICAgICAgICAgICAgb25UcmFuc2l0aW9uLmFjY2VwdChuZXdTdGF0ZSk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0xlYWRlcigpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCB0cmFuc2l0aW9uVG9Gb2xsb3dlcigpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidHJhbnNpdGlvblRvRm9sbG93ZXIoKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBGb2xsb3dlciBuZXdTdGF0ZSA9IG5ldyBGb2xsb3dlcihpZCwgcGVlcnMsIHRlcm0sIGxvZywgYXBwbGljYXRvckFjdG9yLCBwZWVyc0FjdG9yLCBvblRyYW5zaXRpb24sIG51bGwsIC0xLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMsIHJhZnRBY3Rvcik7CiAgICAgICAgICAgICAgICBvblRyYW5zaXRpb24uYWNjZXB0KG5ld1N0YXRlKTsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidHJhbnNpdGlvblRvRm9sbG93ZXIoKSAtIGVuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHN0YXRpYyBUZXJtIGluaXRUZXJtKFRlcm0gdGVybSkgewogICAgICAgICAgICAgICAgdHJ5IChUZXJtLlRyYW5zYWN0aW9uIHR4ID0gdGVybS50cmFuc2FjdGlvbigpKSB7CiAgICAgICAgICAgICAgICAgICAgdHguc2V0VGVybSh0eC5maW5kVGVybSgpLm9yRWxzZSgtMUwpKTsKICAgICAgICAgICAgICAgICAgICB0eC5zZXRIYXNWb3RlZEZvclRoaXNUZXJtKHR4LmZpbmRIYXNWb3RlZEZvclRoaXNUZXJtKCkub3JFbHNlKGZhbHNlKSk7CiAgICAgICAgICAgICAgICAgICAgdHguY29tbWl0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGVybTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY2xhc3MgTGVhZGVyIGV4dGVuZHMgQmFzZSB7CiAgICAgICAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihMZWFkZXIuY2xhc3MpOwoKICAgICAgICAgICAgbG9uZyBsYXN0QXBwbGllZDsKICAgICAgICAgICAgZmluYWwgQWN0b3I8UmFmdD4gcmFmdEFjdG9yOwogICAgICAgICAgICBmaW5hbCBNYXA8UmFmdElkLCBMb25nPiBuZXh0SW5kaWNlczsKICAgICAgICAgICAgZmluYWwgQWN0b3JQZXJpb2RpY1Rhc2s8UmFmdD4gaGVhcnRiZWF0VGltZXI7CiAgICAgICAgICAgIGZpbmFsIFJlcGxpY2F0aW9ucyByZXBsaWNhdGlvbnM7CgogICAgICAgICAgICBMZWFkZXIoUmFmdElkIGlkLCBTZXQ8UmFmdElkPiBwZWVycywgVGVybSB0ZXJtLCBMb2cgbG9nLCBBY3Rvcjw/IGV4dGVuZHMgQXBwbGljYXRvcj4gYXBwbGljYXRvckFjdG9yLCBBY3RvcjxQZWVycz4gcGVlcnNBY3RvciwKICAgICAgICAgICAgICAgICAgIENvbnN1bWVyPEJhc2U+IG9uVHJhbnNpdGlvbiwgbG9uZyBsYXN0QXBwbGllZCwgaW50IGVsZWN0aW9uVGltZW91dE1zLCBpbnQgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGludCBoZWFydGJlYXRJbnRlcnZhbE1zLCBBY3RvcjxSYWZ0PiByYWZ0QWN0b3IpIHsKICAgICAgICAgICAgICAgIHN1cGVyKGlkLCBwZWVycywgdGVybSwgbG9nLCBhcHBsaWNhdG9yQWN0b3IsIHBlZXJzQWN0b3IsIG9uVHJhbnNpdGlvbiwgaWQsIGVsZWN0aW9uVGltZW91dE1zLCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaGVhcnRiZWF0SW50ZXJ2YWxNcyk7CiAgICAgICAgICAgICAgICB0aGlzLmxhc3RLbm93bkxlYWRlciA9IGlkOwogICAgICAgICAgICAgICAgdGhpcy5sYXN0QXBwbGllZCA9IGxhc3RBcHBsaWVkOwogICAgICAgICAgICAgICAgdGhpcy5yYWZ0QWN0b3IgPSByYWZ0QWN0b3I7CiAgICAgICAgICAgICAgICBuZXh0SW5kaWNlcyA9IGNyZWF0ZU5leHRJbmRpY2VzKHBlZXJzLCBsb2cuZ2V0TGF0ZXN0KCkpOwogICAgICAgICAgICAgICAgaGVhcnRiZWF0VGltZXIgPSBuZXcgQWN0b3JQZXJpb2RpY1Rhc2s8PigKICAgICAgICAgICAgICAgICAgICAgICAgcmFmdEFjdG9yLAogICAgICAgICAgICAgICAgICAgICAgICBoZWFydGJlYXRJbnRlcnZhbE1zLAogICAgICAgICAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgICAgICAgICByYWZ0IC0+IGhlYXJ0YmVhdChwZWVycywgdGVybSwgbG9nLCBwZWVyc0FjdG9yKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGhlYXJ0YmVhdFRpbWVyLnJlc3RhcnQoKTsKICAgICAgICAgICAgICAgIHJlcGxpY2F0aW9ucyA9IG5ldyBSZXBsaWNhdGlvbnMocGVlcnMpOwoKICAgICAgICAgICAgICAgIGlmIChsb2cuZ2V0TGF0ZXN0KCkuaXNQcmVzZW50KCkpIHsKICAgICAgICAgICAgICAgICAgICByZXBsaWNhdGVFbnRyaWVzKGlkLCBwZWVycywgbGlzdChsb2cuZ2V0TGF0ZXN0KCkuZ2V0KCkpLCBwZWVyc0FjdG9yLCBsb2csIHRlcm0sIFZvaWQgLT4gewogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBoZWFydGJlYXQocGVlcnMsIHRlcm0sIGxvZywgcGVlcnNBY3Rvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXBsaWNhdGUoQnl0ZUJ1ZmZlciBjb250ZW50LCBDb25zdW1lcjxWb2lkPiBvbkNvbW1pdHRlZCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJyZXBsaWNhdGUoLi4uLC4uLikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgbG9uZyB0ZXJtID0gdGhpcy50ZXJtLmdldFRlcm0oKTsKICAgICAgICAgICAgICAgIE9wdGlvbmFsPExvZy5FbnRyeT4gbGF0ZXN0RW50cnkgPSBsb2cuZ2V0TGF0ZXN0KCk7CiAgICAgICAgICAgICAgICBMb25nIGxhdGVzdEluZGV4ID0gbGF0ZXN0RW50cnkubWFwKExvZy5FbnRyeTo6aW5kZXgpLm9yRWxzZShudWxsKTsKICAgICAgICAgICAgICAgIGxvbmcgbmV4dEluZGV4ID0gbGF0ZXN0SW5kZXggIT0gbnVsbCA/IGxhdGVzdEluZGV4ICsgMUwgOiAwTDsKICAgICAgICAgICAgICAgIExvZy5FbnRyeSBuZXh0RW50cnkgPSBuZXcgTG9nLkVudHJ5KG5leHRJbmRleCwgdGVybSwgY29udGVudCk7CgogICAgICAgICAgICAgICAgbG9nLnB1dChuZXh0RW50cnkpOwoKICAgICAgICAgICAgICAgIGlmIChwZWVycy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgICAgICAgICBjb21taXQoIltvcGVyYXRpb25dIiwgbmV4dEVudHJ5LmVudHJ5SWQoKSk7CiAgICAgICAgICAgICAgICAgICAgb25Db21taXR0ZWQuYWNjZXB0KG51bGwpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBTZXQ8UmFmdElkPiBwZWVycyA9IG5leHRJbmRpY2VzLmVudHJ5U2V0KCkuc3RyZWFtKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoa3YgLT4ga3YuZ2V0VmFsdWUoKSA9PSBuZXh0SW5kZXgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKE1hcC5FbnRyeTo6Z2V0S2V5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNvbGxlY3QoQ29sbGVjdG9ycy50b1NldCgpKTsKICAgICAgICAgICAgICAgICAgICByZXBsaWNhdGVFbnRyaWVzKHRoaXMuaWQsIHBlZXJzLCBsaXN0KGxvZy5nZXQobmV4dEluZGV4KS5nZXQoKSksIHBlZXJzQWN0b3IsIHRoaXMubG9nLCB0aGlzLnRlcm0sIG9uQ29tbWl0dGVkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygicmVwbGljYXRlKC4uLiwuLi4pIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXF1ZXN0Vm90ZVJlcShSYWZ0SWQgY2FuZGlkYXRlLCBsb25nIHRlcm0sIEBOdWxsYWJsZSBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVxKCIgKyBjYW5kaWRhdGUgKyAiLCAiICsgdGVybSArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgdHJ5IChUZXJtLlRyYW5zYWN0aW9uIHR4ID0gdGhpcy50ZXJtLnRyYW5zYWN0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICBib29sZWFuIGdyYW50Vm90ZTsKICAgICAgICAgICAgICAgICAgICBpZiAodGVybSA+IHR4LmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0eC5zZXRUZXJtKHRlcm0pOwogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uVG9Gb2xsb3dlcigpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVybSA8IHR4LmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSAhdHguZ2V0SGFzVm90ZWRGb3JUaGlzVGVybSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0eC5zZXRIYXNWb3RlZEZvclRoaXNUZXJtKHRydWUpOwoKICAgICAgICAgICAgICAgICAgICB0eC5jb21taXQoKTsKICAgICAgICAgICAgICAgICAgICBwZWVyc0FjdG9yLnRlbGwocGVlcnMgLT4gcGVlcnMucGVlcihjYW5kaWRhdGUuYWRkcmVzcygpKS5zZW5kUmVxdWVzdFZvdGVSZXMoaWQsIHRlcm0sIGdyYW50Vm90ZSkpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygicmVxdWVzdFZvdGVSZXEoIiArIGNhbmRpZGF0ZSArICIsICIgKyB0ZXJtICsgIiwgIiArIGxhdGVzdEVudHJ5SWQgKyAiKSAtIGVuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgcmVxdWVzdFZvdGVSZXMoUmFmdElkIHBlZXIsIGxvbmcgdGVybSwgYm9vbGVhbiB2b3RlR3JhbnRlZCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJyZXF1ZXN0Vm90ZVJlcygiICsgcGVlciArICIsICIgKyB0ZXJtICsgIiwgIiArIHZvdGVHcmFudGVkICsgIikgLSBpZ25vcmUgKGFscmVhZHkgYSBsZWFkZXIpIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBhcHBlbmRFbnRyaWVzUmVxKFJhZnRJZCBsZWFkZXIsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIHByZXZFbnRyeUlkLCBMaXN0PExvZy5FbnRyeT4gZW50cmllcywgQE51bGxhYmxlIExvbmcgbGVhZGVyQ29tbWl0KSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoImFwcGVuZEVudHJpZXNSZXEoIiArIGxlYWRlciArICIsICIgKyB0ZXJtICsgIiwgIiArIHByZXZFbnRyeUlkICsgIiwgIiArIGVudHJpZXMgKyAiLCAiICsgbGVhZGVyQ29tbWl0ICsgIikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgaWYgKHRlcm0gPiB0aGlzLnRlcm0uZ2V0VGVybSgpKSB7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvRm9sbG93ZXIoKS5hcHBlbmRFbnRyaWVzUmVxKGxlYWRlciwgdGVybSwgcHJldkVudHJ5SWQsIGVudHJpZXMsIGxlYWRlckNvbW1pdCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoImFwcGVuZEVudHJpZXNSZXEoIiArIGxlYWRlciArICIsICIgKyB0ZXJtICsgIiwgIiArIHByZXZFbnRyeUlkICsgIiwgIiArIGVudHJpZXMgKyAiLCAiICsgbGVhZGVyQ29tbWl0ICsgIikgLSBlbmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFwcGVuZEVudHJpZXNSZXMoUmFmdElkIGZvbGxvd2VyLCBsb25nIHRlcm0sIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5SWQsIGJvb2xlYW4gc3VjY2VzcykgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJhcHBlbmRFbnRyaWVzUmVzKCIgKyBmb2xsb3dlciArICIsICIgKyB0ZXJtICsgIiwgIiArIGxhdGVzdEVudHJ5SWQgKyAiLCAiICsgc3VjY2VzcyArICIpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIGlmICh0ZXJtIDwgdGhpcy50ZXJtLmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiUmVjZWl2aW5nIGEgaW5wdXQgZnJvbSBhbiBvbGRlciB0ZXJtICciICsgdGVybSArICInIChjdXJyZW50IHRlcm06ICciICsgdGhpcy50ZXJtLmdldFRlcm0oKSArICInKSAuIElnbm9yaW5nLi4uIik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgUmVwbGljYXRpb25zLlJlcGxpY2F0aW9uIHJlcGxpY2F0aW9uID0gcmVwbGljYXRpb25zLmdldChsYXRlc3RFbnRyeUlkKTsKICAgICAgICAgICAgICAgICAgICByZXBsaWNhdGlvbi5jb3VudChmb2xsb3dlcik7CiAgICAgICAgICAgICAgICAgICAgYm9vbGVhbiByZXBsaWNhdGVkVG9NYWpvcml0eSA9IHJlcGxpY2F0aW9uLmNvdW50cygpID09IE1BSk9SSVRZIHx8IHJlcGxpY2F0aW9uLmNvdW50cygpID09IEFMTDsKICAgICAgICAgICAgICAgICAgICBpZiAocmVwbGljYXRlZFRvTWFqb3JpdHkgJiYgIXJlcGxpY2F0aW9uLmlzQ29tbWl0dGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29tbWl0KCJhcHBlbmRFbnRyaWVzUmVzKC4uLikiLCBsYXRlc3RFbnRyeUlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhdGVzdEVudHJ5SWQuaW5kZXgoKSA9PSBsYXN0QXBwbGllZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGljYXRpb24ubWFya0NvbW1pdHRlZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJhcHBlbmRFbnRyaWVzUmVzKC4uLikgLSAiICsgbGF0ZXN0RW50cnlJZCArICI6IGNvbW1pdHRlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiYXBwZW5kRW50cmllc1JlcyguLi4pIC0gcmVwbGljYXRpb24gb2YgJyIgKyBsYXRlc3RFbnRyeUlkICsgIic6ICciICsgcmVwbGljYXRpb24gKyAiJyIpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxvbmcgbmV3SW5kZXggPSBuZXh0SW5kaWNlcy5jb21wdXRlKGZvbGxvd2VyLCAoa2V5LCB2YWx1ZSkgLT4KICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZU5leHRJbmRleCh2YWx1ZSwgbGF0ZXN0RW50cnlJZCwgc3VjY2VzcykKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBPcHRpb25hbDxMb2cuRW50cnk+IG5leHQgPSBsb2cuZ2V0KG5ld0luZGV4KTsKICAgICAgICAgICAgICAgIGlmIChuZXh0LmlzUHJlc2VudCgpKSB7CiAgICAgICAgICAgICAgICAgICAgcmVwbGljYXRlRW50cmllcyhpZCwgc2V0KGZvbGxvd2VyKSwgbGlzdChuZXh0LmdldCgpKSwgcGVlcnNBY3RvciwgbG9nLCB0aGlzLnRlcm0sIFZvaWQgLT4gewogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJhcHBlbmRFbnRyaWVzUmVzKCIgKyBmb2xsb3dlciArICIsICIgKyB0ZXJtICsgIiwgIiArIGxhdGVzdEVudHJ5SWQgKyAiLCAiICsgc3VjY2VzcyArICIpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBkZWFjdGl2YXRlKCkgewogICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvSW5hY3RpdmUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHByb3RlY3RlZCBMb2dnZXIgbG9nKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIExPRzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHRyYW5zaXRpb25Ub0luYWN0aXZlKCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9JbmFjdGl2ZSgpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIGNsZWFudXAoKTsKICAgICAgICAgICAgICAgIEluYWN0aXZlIG5ld1N0YXRlID0gbmV3IEluYWN0aXZlKGlkLCBwZWVycywgdGVybSwgbG9nLCBhcHBsaWNhdG9yQWN0b3IsIHBlZXJzQWN0b3IsIG9uVHJhbnNpdGlvbiwgZWxlY3Rpb25UaW1lb3V0TXMsIGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zLCBoZWFydGJlYXRJbnRlcnZhbE1zLCByYWZ0QWN0b3IpOwogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9JbmFjdGl2ZSgpIC0gZW5kIik7CiAgICAgICAgICAgICAgICBvblRyYW5zaXRpb24uYWNjZXB0KG5ld1N0YXRlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSBGb2xsb3dlciB0cmFuc2l0aW9uVG9Gb2xsb3dlcigpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidHJhbnNpdGlvblRvRm9sbG93ZXIoKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7CiAgICAgICAgICAgICAgICBGb2xsb3dlciBuZXdTdGF0ZSA9IG5ldyBGb2xsb3dlcihpZCwgcGVlcnMsIHRlcm0sIGxvZywgYXBwbGljYXRvckFjdG9yLCBwZWVyc0FjdG9yLCBvblRyYW5zaXRpb24sIGxhc3RLbm93bkxlYWRlciwgbGFzdEFwcGxpZWQsIGVsZWN0aW9uVGltZW91dE1zLCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaGVhcnRiZWF0SW50ZXJ2YWxNcywgcmFmdEFjdG9yKTsKICAgICAgICAgICAgICAgIG9uVHJhbnNpdGlvbi5hY2NlcHQobmV3U3RhdGUpOwogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9Gb2xsb3dlcigpIC0gZW5kIik7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3U3RhdGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBjbGVhbnVwKCkgewogICAgICAgICAgICAgICAgaGVhcnRiZWF0VGltZXIuc3RvcCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIE1hcDxSYWZ0SWQsIExvbmc+IGNyZWF0ZU5leHRJbmRpY2VzKFNldDxSYWZ0SWQ+IGZvbGxvd2VycywgT3B0aW9uYWw8TG9nLkVudHJ5PiBsYXRlc3QpIHsKICAgICAgICAgICAgICAgIE1hcDxSYWZ0SWQsIExvbmc+IG5leHRJbmRpY2VzID0gbmV3IEhhc2hNYXA8PigpOwoKICAgICAgICAgICAgICAgIGZvciAoUmFmdElkIGZvbGxvd2VyIDogZm9sbG93ZXJzKSB7CiAgICAgICAgICAgICAgICAgICAgTG9uZyBuZXh0SW5kZXggPSBsYXRlc3QubWFwKGUgLT4gZS5pbmRleCgpICsgMSkub3JFbHNlKDBMKTsKICAgICAgICAgICAgICAgICAgICBuZXh0SW5kaWNlcy5wdXQoZm9sbG93ZXIsIG5leHRJbmRleCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIG5leHRJbmRpY2VzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIGxvbmcgY29tcHV0ZU5leHRJbmRleChsb25nIGN1cnJlbnRJbmRleCwgTG9nLkVudHJ5SWQgbGF0ZXN0RW50cnlJZCwgYm9vbGVhbiBzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SW5kZXggPT0gbGF0ZXN0RW50cnlJZC5pbmRleCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50SW5kZXggKyAxOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50SW5kZXg7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudEluZGV4IC0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIGNvbW1pdChTdHJpbmcgZXZlbnRUeXBlLCBMb2cuRW50cnlJZCBpZCkgewogICAgICAgICAgICAgICAgZm9yIChsb25nIGkgPSBsYXN0QXBwbGllZCArIDE7IGkgPD0gaWQuaW5kZXgoKTsgKytpKSB7CiAgICAgICAgICAgICAgICAgICAgYXBwbGljYXRvckFjdG9yLnJ1bihjIC0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgTG9nLkVudHJ5IGVudHJ5ID0gbG9nLmdldChpZC5pbmRleCgpKS5nZXQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYy5hcHBseShlbnRyeS5jb250ZW50KCkpOwogICAgICAgICAgICAgICAgICAgIH0pLmF3YWl0VW5jaGVja2VkKCk7CgogICAgICAgICAgICAgICAgICAgIGxhc3RBcHBsaWVkICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoZXZlbnRUeXBlICsgIiAtIGxvZyAnIiArIGlkICsgIicgY29tbWl0dGVkLiBsYXN0QXBwbGllZCBzZXQgdG8gJyIgKyBsYXN0QXBwbGllZCArICInIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBoZWFydGJlYXQoU2V0PFJhZnRJZD4gcGVlcnMsIFRlcm0gdGVybSwgTG9nIGxvZywgQWN0b3I8UGVlcnM+IHBlZXJzQWN0b3IpIHsKICAgICAgICAgICAgICAgIHJlcGxpY2F0ZUVudHJpZXModGhpcy5pZCwgcGVlcnMsIGxpc3QoKSwgcGVlcnNBY3RvciwgbG9nLCB0ZXJtLCBWb2lkIC0+IHsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgcmVwbGljYXRlRW50cmllcyhSYWZ0SWQgaWQsIFNldDxSYWZ0SWQ+IHBlZXJJZHMsIExpc3Q8TG9nLkVudHJ5PiBlbnRyaWVzLCBBY3RvcjxQZWVycz4gcGVlcnNBY3RvciwgTG9nIGxvZywgVGVybSB0ZXJtLCBDb25zdW1lcjxWb2lkPiBvbkNvbW1pdHRlZCkgewogICAgICAgICAgICAgICAgZm9yIChMb2cuRW50cnkgZW50cnkgOiBlbnRyaWVzKSB7CiAgICAgICAgICAgICAgICAgICAgcmVwbGljYXRpb25zLmNyZWF0ZShlbnRyeSwgb25Db21taXR0ZWQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTG9nLkVudHJ5SWQgcHJldmlvdXMgPSAhZW50cmllcy5pc0VtcHR5KCkgPwogICAgICAgICAgICAgICAgICAgICAgICBsb2cuZ2V0KGVudHJpZXMuZ2V0KDApLmVudHJ5SWQoKS5pbmRleCgpIC0gMSkubWFwKExvZy5FbnRyeTo6ZW50cnlJZCkub3JFbHNlKG51bGwpIDoKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmdldExhdGVzdCgpLm1hcChMb2cuRW50cnk6OmVudHJ5SWQpLm9yRWxzZShudWxsKTsKICAgICAgICAgICAgICAgIGZvciAoUmFmdElkIHBlZXJJZCA6IHBlZXJJZHMpIHsKICAgICAgICAgICAgICAgICAgICBwZWVyc0FjdG9yLnRlbGwocGVlcnMgLT4gewogICAgICAgICAgICAgICAgICAgICAgICBMT0cuZGVidWcoInNlbmRBcHBlbmRFbnRyaWVzUmVxKHt9LCB7fSwge30sIHt9LCB7fSkiLCBpZCwgdGVybS5nZXRUZXJtKCksIHByZXZpb3VzLCBlbnRyaWVzLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcGVlcnMucGVlcihwZWVySWQuYWRkcmVzcygpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZW5kQXBwZW5kRW50cmllc1JlcShpZCwgdGVybS5nZXRUZXJtKCksIHByZXZpb3VzLCBlbnRyaWVzLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY2xhc3MgQ2FuZGlkYXRlIGV4dGVuZHMgQmFzZSB7CiAgICAgICAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvZ2dlciBMT0cgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihDYW5kaWRhdGUuY2xhc3MpOwoKICAgICAgICAgICAgZmluYWwgQWN0b3I8UmFmdD4gcmFmdEFjdG9yOwogICAgICAgICAgICBmaW5hbCBsb25nIGxhc3RBcHBsaWVkOwogICAgICAgICAgICBmaW5hbCBBY3RvclBlcmlvZGljVGFzazxSYWZ0PiBlbGVjdGlvblRpbWVyOwogICAgICAgICAgICBpbnQgdm90ZUZyb21QZWVyc0ZvclRoaXNUZXJtOwoKICAgICAgICAgICAgQ2FuZGlkYXRlKFJhZnRJZCBpZCwgU2V0PFJhZnRJZD4gcGVlcnMsIFRlcm0gdGVybSwgTG9nIGxvZywgQWN0b3I8PyBleHRlbmRzIEFwcGxpY2F0b3I+IGFwcGxpY2F0b3JBY3RvciwgQWN0b3I8UGVlcnM+IHBlZXJzQWN0b3IsCiAgICAgICAgICAgICAgICAgICAgICBDb25zdW1lcjxCYXNlPiBvblRyYW5zaXRpb24sIEBOdWxsYWJsZSBSYWZ0SWQgbGFzdEtub3duTGVhZGVyLCBpbnQgZWxlY3Rpb25UaW1lb3V0TXMsIGludCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaW50IGhlYXJ0YmVhdEludGVydmFsTXMsIEFjdG9yPFJhZnQ+IHJhZnRBY3RvciwgbG9uZyBsYXN0QXBwbGllZCkgewogICAgICAgICAgICAgICAgc3VwZXIoaWQsIHBlZXJzLCB0ZXJtLCBsb2csIGFwcGxpY2F0b3JBY3RvciwgcGVlcnNBY3Rvciwgb25UcmFuc2l0aW9uLCBsYXN0S25vd25MZWFkZXIsIGVsZWN0aW9uVGltZW91dE1zLCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaGVhcnRiZWF0SW50ZXJ2YWxNcyk7CiAgICAgICAgICAgICAgICB0aGlzLnJhZnRBY3RvciA9IHJhZnRBY3RvcjsKICAgICAgICAgICAgICAgIHRoaXMubGFzdEFwcGxpZWQgPSBsYXN0QXBwbGllZDsKICAgICAgICAgICAgICAgIGVsZWN0aW9uVGltZXIgPSBuZXcgQWN0b3JQZXJpb2RpY1Rhc2s8PigKICAgICAgICAgICAgICAgICAgICAgICAgcmFmdEFjdG9yLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIHJhZnQgLT4gZWxlY3Rpb24ocGVlcnMpCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgZWxlY3Rpb25UaW1lci5yZXN0YXJ0KCk7CiAgICAgICAgICAgICAgICBlbGVjdGlvbihwZWVycyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXF1ZXN0Vm90ZVJlcShSYWZ0SWQgY2FuZGlkYXRlLCBsb25nIHRlcm0sIEBOdWxsYWJsZSBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVxKCIgKyBjYW5kaWRhdGUgKyAiLCAiICsgdGVybSArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgdHJ5IChUZXJtLlRyYW5zYWN0aW9uIHR4ID0gdGhpcy50ZXJtLnRyYW5zYWN0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICBib29sZWFuIGdyYW50Vm90ZTsKICAgICAgICAgICAgICAgICAgICBpZiAodGVybSA+IHR4LmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0eC5zZXRUZXJtKHRlcm0pOwogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uVG9Gb2xsb3dlcigpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGVybSA8IHR4LmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSAhdHguZ2V0SGFzVm90ZWRGb3JUaGlzVGVybSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0eC5zZXRIYXNWb3RlZEZvclRoaXNUZXJtKHRydWUpOwoKICAgICAgICAgICAgICAgICAgICB0eC5jb21taXQoKTsKICAgICAgICAgICAgICAgICAgICBwZWVyc0FjdG9yLnRlbGwocGVlcnMgLT4gcGVlcnMucGVlcihjYW5kaWRhdGUuYWRkcmVzcygpKS5zZW5kUmVxdWVzdFZvdGVSZXMoaWQsIHRlcm0sIGdyYW50Vm90ZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJyZXF1ZXN0Vm90ZVJlcSgiICsgY2FuZGlkYXRlICsgIiwgIiArIHRlcm0gKyAiLCAiICsgbGF0ZXN0RW50cnlJZCArICIpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXF1ZXN0Vm90ZVJlcyhSYWZ0SWQgcGVlciwgbG9uZyB0ZXJtLCBib29sZWFuIHZvdGVHcmFudGVkKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVzKCIgKyBwZWVyICsgIiwgIiArIHRlcm0gKyAiLCAiICsgdm90ZUdyYW50ZWQgKyAiKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBpZiAodGVybSA8IHRoaXMudGVybS5nZXRUZXJtKCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHZvdGVHcmFudGVkKSB7CiAgICAgICAgICAgICAgICAgICAgdm90ZUZyb21QZWVyc0ZvclRoaXNUZXJtKys7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYm9vbGVhbiB2b3RlZEJ5TWFqb3JpdHkgPSB2b3RlRnJvbVBlZXJzRm9yVGhpc1Rlcm0gPj0gZ2V0TWFqb3JpdHlDb3VudChwZWVycyk7CiAgICAgICAgICAgICAgICBpZiAodm90ZWRCeU1ham9yaXR5KSB7CiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvTGVhZGVyKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVzKCIgKyBwZWVyICsgIiwgIiArIHRlcm0gKyAiLCAiICsgdm90ZUdyYW50ZWQgKyAiKSAtIGVuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgYXBwZW5kRW50cmllc1JlcShSYWZ0SWQgbGVhZGVyLCBsb25nIHRlcm0sIEBOdWxsYWJsZSBMb2cuRW50cnlJZCBwcmV2RW50cnlJZCwgTGlzdDxMb2cuRW50cnk+IGVudHJpZXMsIEBOdWxsYWJsZSBMb25nIGxlYWRlckNvbW1pdCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJhcHBlbmRFbnRyaWVzUmVxKCIgKyBsZWFkZXIgKyAiLCAiICsgdGVybSArICIsICIgKyBwcmV2RW50cnlJZCArICIsICIgKyBlbnRyaWVzICsgIiwgIiArIGxlYWRlckNvbW1pdCArICIpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIGlmICh0ZXJtID49IHRoaXMudGVybS5nZXRUZXJtKCkpIHsKICAgICAgICAgICAgICAgICAgICBGb2xsb3dlciBuZXdTdGF0ZSA9IHRyYW5zaXRpb25Ub0ZvbGxvd2VyKCk7CiAgICAgICAgICAgICAgICAgICAgbmV3U3RhdGUuYXBwZW5kRW50cmllc1JlcShsZWFkZXIsIHRlcm0sIHByZXZFbnRyeUlkLCBlbnRyaWVzLCBsZWFkZXJDb21taXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJhcHBlbmRFbnRyaWVzUmVxKCIgKyBsZWFkZXIgKyAiLCAiICsgdGVybSArICIsICIgKyBwcmV2RW50cnlJZCArICIsICIgKyBlbnRyaWVzICsgIiwgIiArIGxlYWRlckNvbW1pdCArICIpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBkZWFjdGl2YXRlKCkgewogICAgICAgICAgICAgICAgdHJhbnNpdGlvblRvSW5hY3RpdmUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHByb3RlY3RlZCBMb2dnZXIgbG9nKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIExPRzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHRyYW5zaXRpb25Ub0luYWN0aXZlKCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9JbmFjdGl2ZSgpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIGNsZWFudXAoKTsKICAgICAgICAgICAgICAgIEluYWN0aXZlIG5ld1N0YXRlID0gbmV3IEluYWN0aXZlKGlkLCBwZWVycywgdGVybSwgbG9nLCBhcHBsaWNhdG9yQWN0b3IsIHBlZXJzQWN0b3IsIG9uVHJhbnNpdGlvbiwgZWxlY3Rpb25UaW1lb3V0TXMsIGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zLCBoZWFydGJlYXRJbnRlcnZhbE1zLCByYWZ0QWN0b3IpOwogICAgICAgICAgICAgICAgb25UcmFuc2l0aW9uLmFjY2VwdChuZXdTdGF0ZSk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0luYWN0aXZlKCkgLSBlbmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSBGb2xsb3dlciB0cmFuc2l0aW9uVG9Gb2xsb3dlcigpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidHJhbnNpdGlvblRvRm9sbG93ZXIoKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7CiAgICAgICAgICAgICAgICBGb2xsb3dlciBuZXdTdGF0ZSA9IG5ldyBGb2xsb3dlcihpZCwgcGVlcnMsIHRlcm0sIGxvZywgYXBwbGljYXRvckFjdG9yLCBwZWVyc0FjdG9yLCBvblRyYW5zaXRpb24sIGxhc3RLbm93bkxlYWRlciwgbGFzdEFwcGxpZWQsIGVsZWN0aW9uVGltZW91dE1zLCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgaGVhcnRiZWF0SW50ZXJ2YWxNcywgcmFmdEFjdG9yKTsKICAgICAgICAgICAgICAgIG9uVHJhbnNpdGlvbi5hY2NlcHQobmV3U3RhdGUpOwogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9Gb2xsb3dlcigpIC0gZW5kIik7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3U3RhdGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCB0cmFuc2l0aW9uVG9MZWFkZXIoKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0xlYWRlcigpIC0gc3RhcnQiKTsKICAgICAgICAgICAgICAgIGNsZWFudXAoKTsKICAgICAgICAgICAgICAgIExlYWRlciBuZXdTdGF0ZSA9IG5ldyBMZWFkZXIoaWQsIHBlZXJzLCB0ZXJtLCBsb2csIGFwcGxpY2F0b3JBY3RvciwgcGVlcnNBY3Rvciwgb25UcmFuc2l0aW9uLCBsYXN0QXBwbGllZCwgZWxlY3Rpb25UaW1lb3V0TXMsIGVsZWN0aW9uVGltZW91dFZhcmlhdGlvbk1zLCBoZWFydGJlYXRJbnRlcnZhbE1zLCByYWZ0QWN0b3IpOwogICAgICAgICAgICAgICAgb25UcmFuc2l0aW9uLmFjY2VwdChuZXdTdGF0ZSk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0xlYWRlcigpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBjbGVhbnVwKCkgewogICAgICAgICAgICAgICAgZWxlY3Rpb25UaW1lci5zdG9wKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBlbGVjdGlvbihTZXQ8UmFmdElkPiBwZWVyQWRkcmVzc2VzKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoImVsZWN0aW9uKCIgKyBwZWVyQWRkcmVzc2VzICsgIikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgdm90ZUZyb21QZWVyc0ZvclRoaXNUZXJtID0gMDsKICAgICAgICAgICAgICAgIHRyeSAoVGVybS5UcmFuc2FjdGlvbiB0eCA9IHRoaXMudGVybS50cmFuc2FjdGlvbigpKSB7CiAgICAgICAgICAgICAgICAgICAgdHguc2V0VGVybSh0eC5nZXRUZXJtKCkgKyAxKTsKICAgICAgICAgICAgICAgICAgICB0eC5zZXRIYXNWb3RlZEZvclRoaXNUZXJtKHRydWUpOwogICAgICAgICAgICAgICAgICAgIHR4LmNvbW1pdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbG9uZyB0ZXJtID0gdGhpcy50ZXJtLmdldFRlcm0oKTsKICAgICAgICAgICAgICAgIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5SWQgPSBsb2cuZ2V0TGF0ZXN0KCkubWFwKExvZy5FbnRyeTo6ZW50cnlJZCkub3JFbHNlKG51bGwpOwogICAgICAgICAgICAgICAgZm9yIChSYWZ0SWQgcGVlckFkZHIgOiBwZWVyQWRkcmVzc2VzKSB7CiAgICAgICAgICAgICAgICAgICAgcGVlcnNBY3Rvci50ZWxsKHBlZXJzIC0+IHBlZXJzLnBlZXIocGVlckFkZHIuYWRkcmVzcygpKS5zZW5kUmVxdWVzdFZvdGVSZXEoaWQsIHRlcm0sIGxhdGVzdEVudHJ5SWQpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiZWxlY3Rpb24oIiArIHBlZXJBZGRyZXNzZXMgKyAiKSAtIGVuZCIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBjbGFzcyBGb2xsb3dlciBleHRlbmRzIEJhc2UgewogICAgICAgICAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoRm9sbG93ZXIuY2xhc3MpOwoKICAgICAgICAgICAgbG9uZyBsYXN0QXBwbGllZDsKICAgICAgICAgICAgZmluYWwgQWN0b3I8UmFmdD4gcmFmdEFjdG9yOwogICAgICAgICAgICBmaW5hbCBBY3RvclBlcmlvZGljVGFzazxSYWZ0PiBjYW5kaWRhY3lUaW1lcjsKCiAgICAgICAgICAgIEZvbGxvd2VyKFJhZnRJZCBpZCwgU2V0PFJhZnRJZD4gcGVlcnMsIFRlcm0gdGVybSwgTG9nIGxvZywgQWN0b3I8PyBleHRlbmRzIEFwcGxpY2F0b3I+IGFwcGxpY2F0b3JBY3RvciwgQWN0b3I8UGVlcnM+IHBlZXJzQWN0b3IsCiAgICAgICAgICAgICAgICAgICAgIENvbnN1bWVyPEJhc2U+IG9uVHJhbnNpdGlvbiwgUmFmdElkIGxhc3RLbm93bkxlYWRlciwgbG9uZyBsYXN0QXBwbGllZCwgaW50IGVsZWN0aW9uVGltZW91dE1zLCBpbnQgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGludCBoZWFydGJlYXRJbnRlcnZhbE1zLCBBY3RvcjxSYWZ0PiByYWZ0QWN0b3IpIHsKICAgICAgICAgICAgICAgIHN1cGVyKGlkLCBwZWVycywgdGVybSwgbG9nLCBhcHBsaWNhdG9yQWN0b3IsIHBlZXJzQWN0b3IsIG9uVHJhbnNpdGlvbiwgbGFzdEtub3duTGVhZGVyLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMpOwogICAgICAgICAgICAgICAgdGhpcy5sYXN0QXBwbGllZCA9IGxhc3RBcHBsaWVkOwogICAgICAgICAgICAgICAgdGhpcy5yYWZ0QWN0b3IgPSByYWZ0QWN0b3I7CiAgICAgICAgICAgICAgICBjYW5kaWRhY3lUaW1lciA9IG5ldyBBY3RvclBlcmlvZGljVGFzazw+KAogICAgICAgICAgICAgICAgICAgICAgICByYWZ0QWN0b3IsIGVsZWN0aW9uVGltZW91dE1zLCBlbGVjdGlvblRpbWVvdXRWYXJpYXRpb25NcywgcmFmdCAtPiB0cmFuc2l0aW9uVG9DYW5kaWRhdGUoKSk7CiAgICAgICAgICAgICAgICBjYW5kaWRhY3lUaW1lci5vbmNlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCByZXF1ZXN0Vm90ZVJlcShSYWZ0SWQgY2FuZGlkYXRlLCBsb25nIHRlcm0sIEBOdWxsYWJsZSBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVxKCIgKyBjYW5kaWRhdGUgKyAiLCAiICsgdGVybSArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIikgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgdHJ5IChUZXJtLlRyYW5zYWN0aW9uIHR4ID0gdGhpcy50ZXJtLnRyYW5zYWN0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICBib29sZWFuIGdyYW50Vm90ZTsKICAgICAgICAgICAgICAgICAgICBpZiAodGVybSA+IHR4LmdldFRlcm0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0eC5zZXRUZXJtKHRlcm0pOwogICAgICAgICAgICAgICAgICAgICAgICBncmFudFZvdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBjYW5kaWRhY3lUaW1lci5vbmNlKCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXJtIDwgdHguZ2V0VGVybSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW50Vm90ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyYW50Vm90ZSA9ICF0eC5nZXRIYXNWb3RlZEZvclRoaXNUZXJtKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHR4LnNldEhhc1ZvdGVkRm9yVGhpc1Rlcm0odHJ1ZSk7CgogICAgICAgICAgICAgICAgICAgIHR4LmNvbW1pdCgpOwogICAgICAgICAgICAgICAgICAgIHBlZXJzQWN0b3IudGVsbChwZWVycyAtPiBwZWVycy5wZWVyKGNhbmRpZGF0ZS5hZGRyZXNzKCkpLnNlbmRSZXF1ZXN0Vm90ZVJlcyhpZCwgdGVybSwgZ3JhbnRWb3RlKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInJlcXVlc3RWb3RlUmVxKCIgKyBjYW5kaWRhdGUgKyAiLCAiICsgdGVybSArICIsICIgKyBsYXRlc3RFbnRyeUlkICsgIikgLSBlbmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFwcGVuZEVudHJpZXNSZXEoUmFmdElkIGxlYWRlciwgbG9uZyB0ZXJtLCBATnVsbGFibGUgTG9nLkVudHJ5SWQgcHJldkVudHJ5SWQsIExpc3Q8TG9nLkVudHJ5PiBlbnRyaWVzLCBATnVsbGFibGUgTG9uZyBsZWFkZXJDb21taXQpIHsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygiYXBwZW5kRW50cmllc1JlcSgiICsgbGVhZGVyICsgIiwgIiArIHRlcm0gKyAiLCAiICsgcHJldkVudHJ5SWQgKyAiLCAiICsgZW50cmllcyArICIsICIgKyBsZWFkZXJDb21taXQgKyAiKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBpZiAodGVybSA8IHRoaXMudGVybS5nZXRUZXJtKCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB1cGRhdGVMZWFkZXJzaGlwKGxlYWRlciwgdGhpcy50ZXJtLCB0ZXJtKTsKICAgICAgICAgICAgICAgIGlmIChlbnRyaWVzLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5SWQgPSBlbnRyaWVzLmdldChlbnRyaWVzLnNpemUoKSAtIDEpLmVudHJ5SWQoKTsKICAgICAgICAgICAgICAgIGJvb2xlYW4gc3VjY2VzczsKICAgICAgICAgICAgICAgIGlmIChlbnRyeUlkTWF0Y2hlcyhsb2csIHByZXZFbnRyeUlkKSkgewogICAgICAgICAgICAgICAgICAgIHBlcnNpc3RFbnRyaWVzKGxvZywgZW50cmllcyk7CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHRydWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBlZXJzQWN0b3IudGVsbChwZWVycyAtPiBwZWVycy5wZWVyKGxlYWRlci5hZGRyZXNzKCkpLnNlbmRBcHBlbmRFbnRyaWVzUmVzKGlkLCB0ZXJtLCBsYXRlc3RFbnRyeUlkLCBzdWNjZXNzKSk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoImFwcGVuZEVudHJpZXNSZXEoIiArIGxlYWRlciArICIsICIgKyB0ZXJtICsgIiwgIiArIHByZXZFbnRyeUlkICsgIiwgIiArIGVudHJpZXMgKyAiLCAiICsgbGVhZGVyQ29tbWl0ICsgIikgLSBlbmQiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGRlYWN0aXZhdGUoKSB7CiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uVG9JbmFjdGl2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHJvdGVjdGVkIExvZ2dlciBsb2coKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTE9HOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgdHJhbnNpdGlvblRvSW5hY3RpdmUoKSB7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0luYWN0aXZlKCkgLSBzdGFydCIpOwogICAgICAgICAgICAgICAgY2xlYW51cCgpOwogICAgICAgICAgICAgICAgSW5hY3RpdmUgbmV3U3RhdGUgPSBuZXcgSW5hY3RpdmUoaWQsIHBlZXJzLCB0ZXJtLCBsb2csIGFwcGxpY2F0b3JBY3RvciwgcGVlcnNBY3Rvciwgb25UcmFuc2l0aW9uLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMsIHJhZnRBY3Rvcik7CiAgICAgICAgICAgICAgICBvblRyYW5zaXRpb24uYWNjZXB0KG5ld1N0YXRlKTsKICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidHJhbnNpdGlvblRvSW5hY3RpdmUoKSAtIGVuZCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgdHJhbnNpdGlvblRvQ2FuZGlkYXRlKCkgewogICAgICAgICAgICAgICAgTE9HLmRlYnVnKCJ0cmFuc2l0aW9uVG9DYW5kaWRhdGUoKSAtIHN0YXJ0Iik7CiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7CiAgICAgICAgICAgICAgICBDYW5kaWRhdGUgbmV3U3RhdGUgPSBuZXcgQ2FuZGlkYXRlKGlkLCBwZWVycywgdGVybSwgbG9nLCBhcHBsaWNhdG9yQWN0b3IsIHBlZXJzQWN0b3IsIG9uVHJhbnNpdGlvbiwgbGFzdEtub3duTGVhZGVyLCBlbGVjdGlvblRpbWVvdXRNcywgZWxlY3Rpb25UaW1lb3V0VmFyaWF0aW9uTXMsIGhlYXJ0YmVhdEludGVydmFsTXMsIHJhZnRBY3RvciwgbGFzdEFwcGxpZWQpOwogICAgICAgICAgICAgICAgb25UcmFuc2l0aW9uLmFjY2VwdChuZXdTdGF0ZSk7CiAgICAgICAgICAgICAgICBMT0cuZGVidWcoInRyYW5zaXRpb25Ub0NhbmRpZGF0ZSgpIC0gZW5kIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBjbGVhbnVwKCkgewogICAgICAgICAgICAgICAgY2FuZGlkYWN5VGltZXIuc3RvcCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIGJvb2xlYW4gZW50cnlJZE1hdGNoZXMoTG9nIGxvZywgQE51bGxhYmxlIExvZy5FbnRyeUlkIGVudHJ5SWQpIHsKICAgICAgICAgICAgICAgIGlmIChlbnRyeUlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBPcHRpb25hbDxMb2cuRW50cnk+IGVudHJ5ID0gbG9nLmdldChlbnRyeUlkLmluZGV4KCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChlbnRyeS5pc1ByZXNlbnQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW50cnkuZ2V0KCkuZW50cnlJZCgpLmVxdWFscyhlbnRyeUlkKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHVwZGF0ZUxlYWRlcnNoaXAoUmFmdElkIGxlYWRlciwgVGVybSB0ZXJtLCBsb25nIG5ld1Rlcm0pIHsKICAgICAgICAgICAgICAgIGNhbmRpZGFjeVRpbWVyLm9uY2UoKTsKICAgICAgICAgICAgICAgIGZpbmFsIGxvbmcgY3VycmVudFRlcm0gPSB0ZXJtLmdldFRlcm0oKTsKICAgICAgICAgICAgICAgIGlmIChuZXdUZXJtID4gY3VycmVudFRlcm0pIHsKICAgICAgICAgICAgICAgICAgICB0cnkgKFRlcm0uVHJhbnNhY3Rpb24gdHggPSB0ZXJtLnRyYW5zYWN0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHguc2V0VGVybShuZXdUZXJtKTsKICAgICAgICAgICAgICAgICAgICAgICAgdHguY29tbWl0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5kZWJ1ZygidXBkYXRlIHRlcm0gZnJvbSB7fSB0byB7fSIsIGN1cnJlbnRUZXJtLCBuZXdUZXJtKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXN0S25vd25MZWFkZXIgIT0gbGVhZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0S25vd25MZWFkZXIgPSBsZWFkZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBwZXJzaXN0RW50cmllcyhMb2cgbG9nLCBMaXN0PExvZy5FbnRyeT4gZW50cmllcykgewogICAgICAgICAgICAgICAgZm9yIChMb2cuRW50cnkgZW50cnkgOiBlbnRyaWVzKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nLnB1dChlbnRyeSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoIWVudHJpZXMuaXNFbXB0eSgpICYmIGxvZy5nZXRMYXRlc3QoKS5pc1ByZXNlbnQoKSkgewogICAgICAgICAgICAgICAgICAgIGxvbmcgZnJvbSA9IGVudHJpZXMuZ2V0KGVudHJpZXMuc2l6ZSgpIC0gMSkuaW5kZXgoKSArIDE7CiAgICAgICAgICAgICAgICAgICAgbG9uZyB0byA9IGxvZy5nZXRMYXRlc3QoKS5nZXQoKS5lbnRyeUlkKCkuaW5kZXgoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxvbmcgaSA9IGZyb207IGkgPD0gdG87IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBsb2cuZGVsZXRlKGkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY2xhc3MgU3RhdHVzIHsKICAgICAgICAgICAgcHJpdmF0ZSBsb25nIHRlcm07CiAgICAgICAgICAgIEBOdWxsYWJsZQogICAgICAgICAgICBwcml2YXRlIFJhZnRJZCBsZWFkZXI7CiAgICAgICAgICAgIHByaXZhdGUgU2V0PFJhZnRJZD4gbm9uTGVhZGVyczsKCiAgICAgICAgICAgIHB1YmxpYyBTdGF0dXMobG9uZyB0ZXJtLCBATnVsbGFibGUgUmFmdElkIGxlYWRlciwgU2V0PFJhZnRJZD4gbm9uTGVhZGVycykgewogICAgICAgICAgICAgICAgdGhpcy50ZXJtID0gdGVybTsKICAgICAgICAgICAgICAgIHRoaXMubGVhZGVyID0gbGVhZGVyOwogICAgICAgICAgICAgICAgdGhpcy5ub25MZWFkZXJzID0gbm9uTGVhZGVyczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGxvbmcgdGVybSgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0ZXJtOwogICAgICAgICAgICB9CgogICAgICAgICAgICBATnVsbGFibGUKICAgICAgICAgICAgcHVibGljIFJhZnRJZCBsYXN0S25vd25MZWFkZXIoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbGVhZGVyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgU2V0PFJhZnRJZD4gbm9uTGVhZGVycygpIHsKICAgICAgICAgICAgICAgIHJldHVybiBub25MZWFkZXJzOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==</text>
      </register>
      <register name="q" type="4">
        <keys>
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="65535" code="65" mods="130" />
          <key char="94" code="0" mods="0" />
          <key char="106" code="0" mods="0" />
        </keys>
      </register>
      <register name="2" type="2">
        <text encoding="base64">cGFja2FnZSBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQucmFmdDsKCmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkJ5dGVTdHJpbmc7CmltcG9ydCBjb20uZ29vZ2xlLnByb3RvYnVmLkludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbjsKaW1wb3J0IGdyYWtuLmNsdXN0ZXIuY29uY3VycmVudC5yYWZ0LmNvbW1vbi5SYWZ0SWQ7CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQuYWN0b3IuQWN0b3I7CmltcG9ydCBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQuYWN0b3IuUHJvbWlzZTsKaW1wb3J0IGdyYWtuLmNsdXN0ZXIuY29uY3VycmVudC5yYWZ0LmNvbXBvbmVudHMuTG9nOwppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LnJhZnQuY29tcG9uZW50cy5OZXR3b3JraW5nOwppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LnJhZnQuY29uc2Vuc3VzLnByb3RvY29sLlJhZnRQcm90bzsKaW1wb3J0IG9yZy5zbGY0ai5Mb2dnZXI7CmltcG9ydCBvcmcuc2xmNGouTG9nZ2VyRmFjdG9yeTsKCmltcG9ydCBqYXZheC5hbm5vdGF0aW9uLk51bGxhYmxlOwppbXBvcnQgamF2YS5uaW8uQnl0ZUJ1ZmZlcjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLnN0cmVhbS5Db2xsZWN0b3JzOwoKcHVibGljIGNsYXNzIFBlZXJzIGltcGxlbWVudHMgQXV0b0Nsb3NlYWJsZSB7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2dnZXIgTE9HID0gTG9nZ2VyRmFjdG9yeS5nZXRMb2dnZXIoUGVlcnMuY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgTWFwPFN0cmluZywgUGVlcj4gcGVlcnMgPSBuZXcgSGFzaE1hcDw+KCk7CgogICAgcHJpdmF0ZSBBY3RvcjxSYWZ0PiByYWZ0QWN0b3I7CiAgICBwcml2YXRlIGZpbmFsIEFjdG9yPD8gZXh0ZW5kcyBOZXR3b3JraW5nPiBuZXR3b3JraW5nQWN0b3I7CgogICAgcHJpdmF0ZSBBY3RvcjxQZWVycz4gYWN0b3I7CgogICAgcHJpdmF0ZSBQZWVycyhBY3RvcjxSYWZ0PiByYWZ0QWN0b3IsIEFjdG9yPD8gZXh0ZW5kcyBOZXR3b3JraW5nPiBuZXR3b3JraW5nQWN0b3IpIHsKICAgICAgICB0aGlzLnJhZnRBY3RvciA9IHJhZnRBY3RvcjsKICAgICAgICB0aGlzLm5ldHdvcmtpbmdBY3RvciA9IG5ldHdvcmtpbmdBY3RvcjsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIFByb21pc2U8QWN0b3I8UGVlcnM+PiBjcmVhdGUoQWN0b3I8Pz4gcGFyZW50QWN0b3IsIEFjdG9yPFJhZnQ+IHJhZnRBY3RvciwgQWN0b3I8PyBleHRlbmRzIE5ldHdvcmtpbmc+IG5ldHdvcmtpbmdBY3RvcikgewogICAgICAgIHJldHVybiBwYXJlbnRBY3Rvci5jaGlsZCgoKSAtPiB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUGVlcnMocmFmdEFjdG9yLCBuZXR3b3JraW5nQWN0b3IpOwogICAgICAgIH0pLnRoZW5XYWl0VW50aWwocGVlcnNBY3RvciAtPiB7CiAgICAgICAgICAgIHJldHVybiBwZWVyc0FjdG9yLnJ1bihwZWVycyAtPiB7CiAgICAgICAgICAgICAgICBwZWVycy5hY3RvciA9IHBlZXJzQWN0b3I7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQoKICAgIHB1YmxpYyBQcm9taXNlPFBlZXI+IGNyZWF0ZVBlZXIoU3RyaW5nIGFkZHJlc3MpIHsKICAgICAgICBmaW5hbCBQcm9taXNlPD8gZXh0ZW5kcyBBY3Rvcjw/IGV4dGVuZHMgTmV0d29ya2luZy5Db25uZWN0aW9uPj4gcHJvbWlzZSA9IG5ldHdvcmtpbmdBY3Rvci53YWl0Rm9yKG5ldHdvcmtpbmcgLT4gbmV0d29ya2luZy5jb25uZWN0KGFkZHJlc3MpKTsKICAgICAgICByZXR1cm4gcHJvbWlzZQogICAgICAgICAgICAudGhlbihQZWVyOjpuZXcpCiAgICAgICAgICAgIC50aGVuUnVuKHBlZXIgLT4gcGVlcnMucHV0KGFkZHJlc3MsIHBlZXIpKTsKICAgIH0KCiAgICBQZWVyIHBlZXIoU3RyaW5nIGFkZHJlc3MpIHsKICAgICAgICByZXR1cm4gcGVlcnMuZ2V0KGFkZHJlc3MpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgcGVlcnMudmFsdWVzKCkuZm9yRWFjaChQZWVycy5QZWVyOjpjbG9zZSk7CiAgICAgICAgcGVlcnMuY2xlYXIoKTsKICAgIH0KCiAgICBjbGFzcyBQZWVyIGltcGxlbWVudHMgQXV0b0Nsb3NlYWJsZSB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBBY3Rvcjw/IGV4dGVuZHMgTmV0d29ya2luZy5Db25uZWN0aW9uPiBjb25uZWN0aW9uQWN0b3I7CgogICAgICAgIHByaXZhdGUgUGVlcihBY3Rvcjw/IGV4dGVuZHMgTmV0d29ya2luZy5Db25uZWN0aW9uPiBjb25uZWN0aW9uQWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5jb25uZWN0aW9uQWN0b3IgPSBjb25uZWN0aW9uQWN0b3I7CiAgICAgICAgICAgIGNvbm5lY3Rpb25BY3Rvci50ZWxsKGNvbm4gLT4gY29ubi5saXN0ZW4oYnl0ZUJ1ZmZlciAtPiBhY3Rvci50ZWxsKHBlZXJzIC0+IHRoaXMucmVjZWl2ZShieXRlQnVmZmVyKSkpKTsKICAgICAgICB9CgogICAgICAgIHZvaWQgc2VuZFJlcXVlc3RWb3RlUmVxKFJhZnRJZCBjYW5kaWRhdGUsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5SWQpIHsKICAgICAgICAgICAgUmFmdFByb3RvLlJhZnRNZXNzYWdlIG1lc3NhZ2UgPSBSYWZ0UHJvdG8uUmFmdE1lc3NhZ2UubmV3QnVpbGRlcigpLnNldFJlcXVlc3RWb3RlUmVxKGNyZWF0ZVByb3RvYnVmUmVxdWVzdFZvdGVSZXEoY2FuZGlkYXRlLCB0ZXJtLCBsYXRlc3RFbnRyeUlkKSkuYnVpbGQoKTsKICAgICAgICAgICAgY29ubmVjdGlvbkFjdG9yLnRlbGwoY29ubiAtPiBjb25uLnNlbmQobWVzc2FnZS50b0J5dGVTdHJpbmcoKS5hc1JlYWRPbmx5Qnl0ZUJ1ZmZlcigpKSk7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHNlbmRSZXF1ZXN0Vm90ZVJlcyhSYWZ0SWQgcGVlciwgbG9uZyB0ZXJtLCBib29sZWFuIHZvdGVHcmFudGVkKSB7CiAgICAgICAgICAgIFJhZnRQcm90by5SYWZ0TWVzc2FnZSBtZXNzYWdlID0gUmFmdFByb3RvLlJhZnRNZXNzYWdlLm5ld0J1aWxkZXIoKS5zZXRSZXF1ZXN0Vm90ZVJlcyhjcmVhdGVQcm90b2J1ZlJlcXVlc3RWb3RlUmVzKHBlZXIsIHRlcm0sIHZvdGVHcmFudGVkKSkuYnVpbGQoKTsKICAgICAgICAgICAgY29ubmVjdGlvbkFjdG9yLnRlbGwoY29ubiAtPiBjb25uLnNlbmQobWVzc2FnZS50b0J5dGVTdHJpbmcoKS5hc1JlYWRPbmx5Qnl0ZUJ1ZmZlcigpKSk7CiAgICAgICAgfQoKICAgICAgICB2b2lkIHNlbmRBcHBlbmRFbnRyaWVzUmVxKFJhZnRJZCBsZWFkZXIsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIHByZXZFbnRyeUlkLCBMaXN0PExvZy5FbnRyeT4gZW50cmllcywgQE51bGxhYmxlIExvbmcgbGVhZGVyQ29tbWl0KSB7CiAgICAgICAgICAgIFJhZnRQcm90by5SYWZ0TWVzc2FnZSBtZXNzYWdlID0gUmFmdFByb3RvLlJhZnRNZXNzYWdlLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgICAgIC5zZXRBcHBlbmRFbnRyaWVzUmVxKGNyZWF0ZVByb3RvYnVmQXBwZW5kRW50cmllc1JlcShsZWFkZXIsIHRlcm0sIHByZXZFbnRyeUlkLCBlbnRyaWVzLCBsZWFkZXJDb21taXQpKQogICAgICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgICAgICBjb25uZWN0aW9uQWN0b3IudGVsbChjb25uIC0+IGNvbm4uc2VuZChtZXNzYWdlLnRvQnl0ZVN0cmluZygpLmFzUmVhZE9ubHlCeXRlQnVmZmVyKCkpKTsKICAgICAgICB9CgogICAgICAgIHZvaWQgc2VuZEFwcGVuZEVudHJpZXNSZXMoUmFmdElkIGZvbGxvd2VyLCBsb25nIHRlcm0sIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5SWQsIGJvb2xlYW4gc3VjY2VzcykgewogICAgICAgICAgICBSYWZ0UHJvdG8uUmFmdE1lc3NhZ2UgbWVzc2FnZSA9IFJhZnRQcm90by5SYWZ0TWVzc2FnZS5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgICAgICAgICAuc2V0QXBwZW5kRW50cmllc1JlcyhjcmVhdGVQcm90b2J1ZkFwcGVuZEVudHJpZXNSZXMoZm9sbG93ZXIsIHRlcm0sIGxhdGVzdEVudHJ5SWQsIHN1Y2Nlc3MpKQogICAgICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgICAgICBjb25uZWN0aW9uQWN0b3IudGVsbChjb25uIC0+IGNvbm4uc2VuZChtZXNzYWdlLnRvQnl0ZVN0cmluZygpLmFzUmVhZE9ubHlCeXRlQnVmZmVyKCkpKTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9pZCByZWNlaXZlKEJ5dGVCdWZmZXIgbWVzc2FnZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgUmFmdFByb3RvLlJhZnRNZXNzYWdlIHJhZnRNZXNzYWdlID0gUmFmdFByb3RvLlJhZnRNZXNzYWdlLnBhcnNlRnJvbShtZXNzYWdlKTsKCiAgICAgICAgICAgICAgICBzd2l0Y2ggKHJhZnRNZXNzYWdlLmdldE1zZ0Nhc2UoKSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgUkVRVUVTVFZPVEVfUkVROiB7CiAgICAgICAgICAgICAgICAgICAgICAgIFJhZnRQcm90by5SZXF1ZXN0Vm90ZS5SZXEgbXNnID0gcmFmdE1lc3NhZ2UuZ2V0UmVxdWVzdFZvdGVSZXEoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmFmdEFjdG9yLnRlbGwocmFmdCAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZnQucmVxdWVzdFZvdGVSZXEoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSYWZ0SWQucGFyc2UobXNnLmdldENhbmRpZGF0ZUlkKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmdldFRlcm0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUVudHJ5SWQobXNnLmdldExhc3RMb2dJbmRleCgpLCBtc2cuZ2V0TGFzdExvZ1Rlcm0oKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlIFJFUVVFU1RWT1RFX1JFUzogewogICAgICAgICAgICAgICAgICAgICAgICBSYWZ0UHJvdG8uUmVxdWVzdFZvdGUuUmVzIG1zZyA9IHJhZnRNZXNzYWdlLmdldFJlcXVlc3RWb3RlUmVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJhZnRBY3Rvci50ZWxsKHJhZnQgLT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYWZ0LnJlcXVlc3RWb3RlUmVzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmFmdElkLnBhcnNlKG1zZy5nZXRSZXNwb25kZXIoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZ2V0VGVybSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmdldFZvdGVHcmFudGVkKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlIEFQUEVOREVOVFJJRVNfUkVROiB7CiAgICAgICAgICAgICAgICAgICAgICAgIFJhZnRQcm90by5BcHBlbmRFbnRyaWVzLlJlcSBtc2cgPSByYWZ0TWVzc2FnZS5nZXRBcHBlbmRFbnRyaWVzUmVxKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIExpc3Q8TG9nLkVudHJ5PiBlbnRyaWVzID0gbXNnLmdldEVudHJpZXNMaXN0KCkuc3RyZWFtKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGVudHJ5IC0+IExvZy5FbnRyeS5mcm9tQnl0ZUJ1ZmZlcihlbnRyeS5hc1JlYWRPbmx5Qnl0ZUJ1ZmZlcigpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmFmdEFjdG9yLnRlbGwocmFmdCAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZnQuYXBwZW5kRW50cmllc1JlcSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJhZnRJZC5wYXJzZShtc2cuZ2V0TGVhZGVySWQoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZ2V0VGVybSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRW50cnlJZChtc2cuZ2V0UHJldkxvZ0luZGV4KCksIG1zZy5nZXRQcmV2TG9nVGVybSgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJpZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2cuZ2V0TGVhZGVyQ29tbWl0KCkgIT0gLTFMID8gbXNnLmdldExlYWRlckNvbW1pdCgpIDogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgQVBQRU5ERU5UUklFU19SRVM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgUmFmdFByb3RvLkFwcGVuZEVudHJpZXMuUmVzIG1zZyA9IHJhZnRNZXNzYWdlLmdldEFwcGVuZEVudHJpZXNSZXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmFmdEFjdG9yLnRlbGwocmFmdCAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhZnQuYXBwZW5kRW50cmllc1JlcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJhZnRJZC5wYXJzZShtc2cuZ2V0UmVzcG9uZGVyKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRW50cnlJZChtc2cuZ2V0TGF0ZXN0RW50cnlJbmRleCgpLCBtc2cuZ2V0TGF0ZXN0RW50cnlUZXJtKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnLmdldFRlcm0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZy5nZXRTdWNjZXNzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlIE1TR19OT1RfU0VUOgogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIExPRy5lcnJvcigiUmVjZWl2ZWQgdW5leHBlY3RlZCBSYWZ0TWVzc2FnZSB0eXBlOiB7fSIsIHJhZnRNZXNzYWdlLmdldE1zZ0Nhc2UoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEludmFsaWRQcm90b2NvbEJ1ZmZlckV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBMT0cuZXJyb3IoIkludGVybmFsIHJhZnQgcHJvdG9jb2wgZGVzZXJpYWxpemF0aW9uIGVycm9yIiwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEBOdWxsYWJsZSBwcml2YXRlIExvZy5FbnRyeUlkIGNyZWF0ZUVudHJ5SWQobG9uZyBpbmRleCwgbG9uZyB0ZXJtKSB7CiAgICAgICAgICAgIExvZy5FbnRyeUlkIGxhdGVzdEVudHJ5OwogICAgICAgICAgICBpZiAoaW5kZXggPT0gLTFMICYmIHRlcm0gPT0gLTFMKSB7CiAgICAgICAgICAgICAgICBsYXRlc3RFbnRyeSA9IG51bGw7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsYXRlc3RFbnRyeSA9IG5ldyBMb2cuRW50cnlJZChpbmRleCwgdGVybSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGxhdGVzdEVudHJ5OwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgICAgIGNvbm5lY3Rpb25BY3Rvci50ZWxsKE5ldHdvcmtpbmcuQ29ubmVjdGlvbjo6Y2xvc2UpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBSYWZ0UHJvdG8uUmVxdWVzdFZvdGUuUmVxIGNyZWF0ZVByb3RvYnVmUmVxdWVzdFZvdGVSZXEoUmFmdElkIGNhbmRpZGF0ZSwgbG9uZyB0ZXJtLCBATnVsbGFibGUgTG9nLkVudHJ5SWQgbGF0ZXN0RW50cnlJZCkgewogICAgICAgICAgICByZXR1cm4gUmFmdFByb3RvLlJlcXVlc3RWb3RlLlJlcS5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgICAgICAgICAuc2V0VGVybSh0ZXJtKQogICAgICAgICAgICAgICAgICAgIC5zZXRDYW5kaWRhdGVJZChjYW5kaWRhdGUudG9TdHJpbmcoKSkKICAgICAgICAgICAgICAgICAgICAuc2V0TGFzdExvZ0luZGV4KGxhdGVzdEVudHJ5SWQgIT0gbnVsbCA/IGxhdGVzdEVudHJ5SWQuaW5kZXgoKSA6IC0xTCkKICAgICAgICAgICAgICAgICAgICAuc2V0TGFzdExvZ1Rlcm0obGF0ZXN0RW50cnlJZCAhPSBudWxsID8gbGF0ZXN0RW50cnlJZC50ZXJtKCkgOiAtMUwpCiAgICAgICAgICAgICAgICAgICAgLmJ1aWxkKCk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIFJhZnRQcm90by5SZXF1ZXN0Vm90ZS5SZXMgY3JlYXRlUHJvdG9idWZSZXF1ZXN0Vm90ZVJlcyhSYWZ0SWQgcGVlciwgbG9uZyB0ZXJtLCBib29sZWFuIHZvdGVHcmFudGVkKSB7CiAgICAgICAgICAgIHJldHVybiBSYWZ0UHJvdG8uUmVxdWVzdFZvdGUuUmVzLm5ld0J1aWxkZXIoKQogICAgICAgICAgICAgICAgICAgIC5zZXRSZXNwb25kZXIocGVlci50b1N0cmluZygpKQogICAgICAgICAgICAgICAgICAgIC5zZXRUZXJtKHRlcm0pCiAgICAgICAgICAgICAgICAgICAgLnNldFZvdGVHcmFudGVkKHZvdGVHcmFudGVkKQogICAgICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBSYWZ0UHJvdG8uQXBwZW5kRW50cmllcy5SZXEgY3JlYXRlUHJvdG9idWZBcHBlbmRFbnRyaWVzUmVxKFJhZnRJZCBsZWFkZXIsIGxvbmcgdGVybSwgQE51bGxhYmxlIExvZy5FbnRyeUlkIHByZXZFbnRyeUlkLCBMaXN0PExvZy5FbnRyeT4gZW50cmllcywgQE51bGxhYmxlIExvbmcgbGVhZGVyQ29tbWl0KSB7CiAgICAgICAgICAgIHJldHVybiBSYWZ0UHJvdG8uQXBwZW5kRW50cmllcy5SZXEubmV3QnVpbGRlcigpCiAgICAgICAgICAgICAgICAgICAgLnNldExlYWRlcklkKGxlYWRlci50b1N0cmluZygpKQogICAgICAgICAgICAgICAgICAgIC5zZXRUZXJtKHRlcm0pCiAgICAgICAgICAgICAgICAgICAgLnNldFByZXZMb2dJbmRleChwcmV2RW50cnlJZCAhPSBudWxsID8gcHJldkVudHJ5SWQuaW5kZXgoKSA6IC0xTCkKICAgICAgICAgICAgICAgICAgICAuc2V0UHJldkxvZ1Rlcm0ocHJldkVudHJ5SWQgIT0gbnVsbCA/IHByZXZFbnRyeUlkLnRlcm0oKSA6IC0xTCkKICAgICAgICAgICAgICAgICAgICAuYWRkQWxsRW50cmllcyhlbnRyaWVzLnN0cmVhbSgpLm1hcChlbnRyeSAtPiBCeXRlU3RyaW5nLmNvcHlGcm9tKGVudHJ5LnRvQnl0ZUJ1ZmZlcigpKSkuY29sbGVjdChDb2xsZWN0b3JzLnRvTGlzdCgpKSkKICAgICAgICAgICAgICAgICAgICAuc2V0TGVhZGVyQ29tbWl0KGxlYWRlckNvbW1pdCAhPSBudWxsID8gbGVhZGVyQ29tbWl0IDogLTFMKQogICAgICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBSYWZ0UHJvdG8uQXBwZW5kRW50cmllcy5SZXMgY3JlYXRlUHJvdG9idWZBcHBlbmRFbnRyaWVzUmVzKFJhZnRJZCBmb2xsb3dlciwgbG9uZyB0ZXJtLCBMb2cuRW50cnlJZCBsYXRlc3RFbnRyeUlkLCBib29sZWFuIHN1Y2Nlc3MpIHsKICAgICAgICAgICAgcmV0dXJuIFJhZnRQcm90by5BcHBlbmRFbnRyaWVzLlJlcy5uZXdCdWlsZGVyKCkKICAgICAgICAgICAgICAgICAgICAuc2V0TGF0ZXN0RW50cnlJbmRleChsYXRlc3RFbnRyeUlkLmluZGV4KCkpCiAgICAgICAgICAgICAgICAgICAgLnNldExhdGVzdEVudHJ5VGVybShsYXRlc3RFbnRyeUlkLnRlcm0oKSkKICAgICAgICAgICAgICAgICAgICAuc2V0VGVybSh0ZXJtKQogICAgICAgICAgICAgICAgICAgIC5zZXRTdWNjZXNzKHN1Y2Nlc3MpCiAgICAgICAgICAgICAgICAgICAgLnNldFJlc3BvbmRlcihmb2xsb3dlci50b1N0cmluZygpKQogICAgICAgICAgICAgICAgICAgIC5idWlsZCgpOwogICAgICAgIH0KCiAgICB9Cn0K</text>
      </register>
      <register name="3" type="2">
        <text encoding="base64">cGFja2FnZSBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQuYWN0b3I7CgppbXBvcnQgZ3Jha24uY2x1c3Rlci5jb25jdXJyZW50LmFjdG9yLnRlc3RraXQuVGVzdFN0YXRlOwppbXBvcnQgb3JnLmp1bml0LkJlZm9yZTsKaW1wb3J0IG9yZy5qdW5pdC5UZXN0OwoKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkJsb2NraW5nUXVldWU7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5MaW5rZWRCbG9ja2luZ1F1ZXVlOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuVGhyZWFkRmFjdG9yeTsKaW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmF0b21pYy5BdG9taWNJbnRlZ2VyOwoKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuQXNzZXJ0LmFzc2VydEVxdWFsczsKCnB1YmxpYyBjbGFzcyBBY3RvclRlc3QgewogICAgcHJpdmF0ZSBCbG9ja2luZ1F1ZXVlPFN0cmluZz4gcmVzdWx0czsKCiAgICBAQmVmb3JlCiAgICBwdWJsaWMgdm9pZCBzZXR1cCgpIHsKICAgICAgICByZXN1bHRzID0gbmV3IExpbmtlZEJsb2NraW5nUXVldWU8PigpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCBwZXJpb2RpY1Rhc2tfbXVzdE5vdEJlSW52b2tlZElmSXRJc1N0b3BwZWRCZWZvcmVUaGVUaW1lb3V0SGFzRWxhcHNlZCgpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgU2luZ2xlVGhyZWFkZWRFdmVudExvb3BQcm9taXNlRXhlY3V0b3Igcm9vdExvb3AgPSBTaW5nbGVUaHJlYWRlZEV2ZW50TG9vcFByb21pc2VFeGVjdXRvci5zdGFydChuYW1lZFRocmVhZEZhY3RvcnkoInJvb3RMb29wIikpOwogICAgICAgIEFjdG9yPFRlc3RTdGF0ZT4gcm9vdCA9IEFjdG9yLnJvb3Qocm9vdExvb3AsIFRlc3RTdGF0ZTo6bmV3KTsKICAgICAgICBBdG9taWNJbnRlZ2VyIGNvdW50ID0gbmV3IEF0b21pY0ludGVnZXIoKTsKICAgICAgICBBY3RvclBlcmlvZGljVGFzazxUZXN0U3RhdGU+IHBlcmlvZGljVGFzayA9IG5ldyBBY3RvclBlcmlvZGljVGFzazw+KHJvb3QsIDEwMDAsIDAsIG1zZyAtPiB7CiAgICAgICAgICAgIGNvdW50LmluY3JlbWVudEFuZEdldCgpOwogICAgICAgIH0pOwogICAgICAgIHBlcmlvZGljVGFzay5vbmNlKCk7CiAgICAgICAgcGVyaW9kaWNUYXNrLnN0b3AoKTsKICAgICAgICBUaHJlYWQuc2xlZXAoMTUwMCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIGNvdW50LmdldCgpKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEFjdG9ycygpIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgU2luZ2xlVGhyZWFkZWRFdmVudExvb3BQcm9taXNlRXhlY3V0b3Igcm9vdExvb3AgPSBTaW5nbGVUaHJlYWRlZEV2ZW50TG9vcFByb21pc2VFeGVjdXRvci5zdGFydChuYW1lZFRocmVhZEZhY3RvcnkoInJvb3RMb29wIikpOwogICAgICAgIFNpbmdsZVRocmVhZGVkRXZlbnRMb29wUHJvbWlzZUV4ZWN1dG9yIHNlc3Npb25Mb29wID0gU2luZ2xlVGhyZWFkZWRFdmVudExvb3BQcm9taXNlRXhlY3V0b3Iuc3RhcnQobmFtZWRUaHJlYWRGYWN0b3J5KCJzZXNzaW9uTG9vcCIpKTsKICAgICAgICBTaW5nbGVUaHJlYWRlZEV2ZW50TG9vcFByb21pc2VFeGVjdXRvciB0eExvb3AgPSBTaW5nbGVUaHJlYWRlZEV2ZW50TG9vcFByb21pc2VFeGVjdXRvci5zdGFydChuYW1lZFRocmVhZEZhY3RvcnkoInR4TG9vcCIpKTsKCiAgICAgICAgUHJvbWlzZS5kZWZlcihyb290TG9vcCwgKCkgLT4gewogICAgICAgICAgICBBY3RvcjxUZXN0U3RhdGU+IHJvb3QgPSBBY3Rvci5yb290KHJvb3RMb29wLCBUZXN0U3RhdGU6Om5ldyk7CiAgICAgICAgICAgIHJvb3QuYXNrKHN0YXRlIC0+IHN0YXRlLjxTZXNzaW9uPmNoaWxkKHNlc3Npb25BY3RvciAtPiBuZXcgU2Vzc2lvbihzZXNzaW9uQWN0b3IsIHNlc3Npb25Mb29wKSkpLnRoZW4oc2Vzc2lvbkFjdG9yIC0+IHsKICAgICAgICAgICAgICAgIFByb21pc2U8QWN0b3I8VHJhbnNhY3Rpb24+PiB0eEFjdG9yUHJvbWlzZSA9IHNlc3Npb25BY3Rvci53YWl0Rm9yKGEgLT4gYS5vcGVuVHJhbnNhY3Rpb24oc2Vzc2lvbkFjdG9yLCAidHgiKSk7CiAgICAgICAgICAgICAgICB0eEFjdG9yUHJvbWlzZS50aGVuRGVmZXIodHggLT4gdHguYXNrKFRyYW5zYWN0aW9uOjpnZXROYW1lKS50aGVuRGVmZXIocmVzdWx0czo6YWRkKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHhBY3RvclByb21pc2U7CiAgICAgICAgICAgIH0pLnRoZW5EZWZlcih0eEFjdG9yUHJvbWlzZSAtPiB7CiAgICAgICAgICAgICAgICB0eEFjdG9yUHJvbWlzZS50aGVuRGVmZXIodHggLT4gewogICAgICAgICAgICAgICAgICAgIHR4LmFzayhUcmFuc2FjdGlvbjo6Z2V0TmFtZSkudGhlbkRlZmVyKHJlc3VsdHM6OmFkZCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIHNsZWVwKDEwMCk7CgogICAgICAgIHJvb3RMb29wLnN0b3AoKTsKICAgICAgICBzZXNzaW9uTG9vcC5zdG9wKCk7CiAgICAgICAgdHhMb29wLnN0b3AoKTsKCiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIHJlc3VsdHMuc2l6ZSgpKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBTZXNzaW9uIGV4dGVuZHMgQWN0b3IuU3RhdGU8U2Vzc2lvbj4gewogICAgICAgIHByaXZhdGUgZmluYWwgU2luZ2xlVGhyZWFkZWRFdmVudExvb3BQcm9taXNlRXhlY3V0b3IgdHhMb29wOwogICAgICAgIHByaXZhdGUgZmluYWwgTGlzdDxBY3RvcjxUcmFuc2FjdGlvbj4+IHRyYW5zYWN0aW9ucyA9IG5ldyBBcnJheUxpc3Q8PigpOwoKICAgICAgICBwcml2YXRlIFNlc3Npb24oQWN0b3I8U2Vzc2lvbj4gc2VsZiwgU2luZ2xlVGhyZWFkZWRFdmVudExvb3BQcm9taXNlRXhlY3V0b3IgdHhMb29wKSB7CiAgICAgICAgICAgIHN1cGVyKHNlbGYpOwogICAgICAgICAgICB0aGlzLnR4TG9vcCA9IHR4TG9vcDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBQcm9taXNlPEFjdG9yPFRyYW5zYWN0aW9uPj4gb3BlblRyYW5zYWN0aW9uKEFjdG9yPFNlc3Npb24+IGFjdG9yLCBTdHJpbmcgbmFtZSkgewogICAgICAgICAgICByZXR1cm4gYWN0b3IuYXNrKHNlc3Npb24gLT4gc2Vzc2lvbi48VHJhbnNhY3Rpb24+Y2hpbGQodHhBY3RvciAtPiBuZXcgVHJhbnNhY3Rpb24odHhBY3RvciwgbmFtZSkpKS50aGVuKHR4QWN0b3IgLT4gewogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25zLmFkZCh0eEFjdG9yKTsKICAgICAgICAgICAgICAgIHJldHVybiB0eEFjdG9yOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgVHJhbnNhY3Rpb24gZXh0ZW5kcyBBY3Rvci5TdGF0ZTxUcmFuc2FjdGlvbj4gewogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIG5hbWU7CgogICAgICAgIHByaXZhdGUgVHJhbnNhY3Rpb24oQWN0b3I8VHJhbnNhY3Rpb24+IHNlbGYsIFN0cmluZyBuYW1lKSB7CiAgICAgICAgICAgIHN1cGVyKHNlbGYpOwogICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgICAgICByZXR1cm4gbmFtZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgVGhyZWFkRmFjdG9yeSBuYW1lZFRocmVhZEZhY3RvcnkoU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gciAtPiBuYW1lZFRocmVhZChuYW1lLCByKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBUaHJlYWQgbmFtZWRUaHJlYWQoU3RyaW5nIG5hbWUsIFJ1bm5hYmxlIHIpIHsKICAgICAgICBUaHJlYWQgdGhyZWFkID0gbmV3IFRocmVhZChyKTsKICAgICAgICB0aHJlYWQuc2V0TmFtZShuYW1lKTsKICAgICAgICByZXR1cm4gdGhyZWFkOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2xlZXAobG9uZyBtaWxsaXMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBUaHJlYWQuc2xlZXAobWlsbGlzKTsKICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuaW50ZXJydXB0KCk7CiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KfQo=</text>
      </register>
      <register name="4" type="2">
        <text encoding="base64">ICAgICAgICAgICAgQWN0b3I8U3RyaW5nPiByb290ID0gbmV3IEFjdG9yPD4ocm9vdExvb3AsICJyb290Iik7Cg==</text>
      </register>
      <register name="5" type="2">
        <text encoding="base64">ICAgICAgICBBY3RvcjxTdHJpbmc+IHJvb3QgPSBuZXcgQWN0b3I8Pihyb290TG9vcCwgInJvb3QiKTsK</text>
      </register>
      <register name="6" type="2">
        <text encoding="base64">ICAgICAgICBBY3Rvcgo=</text>
      </register>
      <register name="7" type="2">
        <text encoding="base64">ICAgICAgICAK</text>
      </register>
      <register name="8" type="2">
        <text encoding="base64">cGFja2FnZSBncmFrbi5jbHVzdGVyLmNvbmN1cnJlbnQuYWN0b3I7CgppbXBvcnQgamF2YXguYW5ub3RhdGlvbi5DaGVja1JldHVyblZhbHVlOwppbXBvcnQgamF2YS51dGlsLmZ1bmN0aW9uLkNvbnN1bWVyOwppbXBvcnQgamF2YS51dGlsLmZ1bmN0aW9uLkZ1bmN0aW9uOwppbXBvcnQgamF2YS51dGlsLmZ1bmN0aW9uLlN1cHBsaWVyOwoKcHVibGljIGNsYXNzIEFjdG9yPEE+IHsKICAgIHByaXZhdGUgZmluYWwgUHJvbWlzZUV4ZWN1dG9yIGV4ZWN1dG9yOwogICAgcHJpdmF0ZSBmaW5hbCBBIGluc3RhbmNlOwoKICAgIHB1YmxpYyBBY3RvcihQcm9taXNlRXhlY3V0b3IgZXhlY3V0b3IsIEEgaW5zdGFuY2UpIHsKICAgICAgICB0aGlzLmV4ZWN1dG9yID0gZXhlY3V0b3I7CiAgICAgICAgdGhpcy5pbnN0YW5jZSA9IGluc3RhbmNlOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgPEE+IEFjdG9yPEE+IGNyZWF0ZShQcm9taXNlRXhlY3V0b3IgZXhlY3V0b3IsIEEgaW5zdGFuY2UpIHsKICAgICAgICByZXR1cm4gbmV3IEFjdG9yPD4oZXhlY3V0b3IsIGluc3RhbmNlKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIDxBPiBQcm9taXNlPEFjdG9yPEE+PiBjcmVhdGUoUHJvbWlzZUV4ZWN1dG9yIGV4ZWN1dG9yLCBTdXBwbGllcjxBPiBjb25zdHJ1Y3RvcikgewogICAgICAgIHJldHVybiBQcm9taXNlLmdldChleGVjdXRvciwgKCkgLT4gbmV3IEFjdG9yPD4oZXhlY3V0b3IsIGNvbnN0cnVjdG9yLmdldCgpKSk7CiAgICB9CgogICAgcHVibGljIFByb21pc2VFeGVjdXRvci5UaW1lZEV2ZW50IHRpbWVkVGFzayhsb25nIG1pbGxpcywgQ29uc3VtZXI8QT4gaGFuZGxlcikgewogICAgICAgIHJldHVybiBleGVjdXRvci5leGVjdXRlKG1pbGxpcywgKCkgLT4gaGFuZGxlci5hY2NlcHQoaW5zdGFuY2UpKTsKICAgIH0KCiAgICBAQ2hlY2tSZXR1cm5WYWx1ZQogICAgcHVibGljIDxWPiBQcm9taXNlPFY+IHdhaXRGb3IoRnVuY3Rpb248QSwgUHJvbWlzZTxWPj4gaGFuZGxlcikgewogICAgICAgIHJldHVybiBQcm9taXNlLndhaXRGb3IoZXhlY3V0b3IsICgpIC0+IGhhbmRsZXIuYXBwbHkoaW5zdGFuY2UpKTsKICAgIH0KCiAgICBAQ2hlY2tSZXR1cm5WYWx1ZQogICAgcHVibGljIDxWPiBQcm9taXNlPFY+IGFzayhGdW5jdGlvbjxBLCBWPiBoYW5kbGVyKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UuZ2V0KGV4ZWN1dG9yLCAoKSAtPiBoYW5kbGVyLmFwcGx5KGluc3RhbmNlKSk7CiAgICB9CgogICAgQENoZWNrUmV0dXJuVmFsdWUKICAgIHB1YmxpYyBQcm9taXNlPFZvaWQ+IHJ1bihDb25zdW1lcjxBPiBoYW5kbGVyKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UucnVuKGV4ZWN1dG9yLCAoKSAtPiBoYW5kbGVyLmFjY2VwdChpbnN0YW5jZSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlbGwoQ29uc3VtZXI8QT4gaGFuZGxlcikgewogICAgICAgIFByb21pc2UuZGVmZXIoZXhlY3V0b3IsICgpIC0+IGhhbmRsZXIuYWNjZXB0KGluc3RhbmNlKSk7CiAgICB9CgogICAgcHVibGljIDxTPiBQcm9taXNlPEFjdG9yPFM+PiBjaGlsZChTdXBwbGllcjxTPiBjb25zdHJ1Y3RvcikgewogICAgICAgIHJldHVybiBjaGlsZChleGVjdXRvciwgY29uc3RydWN0b3IpOwogICAgfQoKICAgIHB1YmxpYyA8Uz4gUHJvbWlzZTxBY3RvcjxTPj4gY2hpbGQoUHJvbWlzZUV4ZWN1dG9yIGV4ZWN1dG9yLCBTdXBwbGllcjxTPiBjb25zdHJ1Y3RvcikgewogICAgICAgIHJldHVybiBQcm9taXNlLndhaXRGb3IodGhpcy5leGVjdXRvciwgKCkgLT4gUHJvbWlzZS5nZXQoZXhlY3V0b3IsICgpIC0+IG5ldyBBY3Rvcjw+KGV4ZWN1dG9yLCBjb25zdHJ1Y3Rvci5nZXQoKSkpKTsKICAgIH0KfQo=</text>
      </register>
      <register name="9" type="2">
        <text encoding="base64">ICAgIGJvb2xlYW4gaXNMb2NhbCgpOwo=</text>
      </register>
      <register name=":" type="4">
        <text>w</text>
      </register>
    </registers>
  </component>
  <component name="VimSearchSettings">
    <search>
      <last-search encoding="base64">XDxzbGVlcFw+</last-search>
      <last-offset />
      <last-pattern encoding="base64">XDxzbGVlcFw+</last-pattern>
      <last-replace>page</last-replace>
      <last-substitute>reference-type</last-substitute>
      <last-dir>1</last-dir>
      <show-last>false</show-last>
    </search>
  </component>
  <component name="VimSettings">
    <state version="6" enabled="true" />
    <notifications>
      <idea-join enabled="true" />
      <idea-put enabled="false" />
    </notifications>
  </component>
</application>